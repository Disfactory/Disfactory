(function(e){function t(t){for(var n,i,c=t[0],s=t[1],l=t[2],p=0,d=[];p<c.length;p++)i=c[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,c=1;c<a.length;c++){var s=a[c];0!==r[s]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={app:0},o=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"0a7e":function(e,t,a){},"1e93":function(e,t,a){},"2aca":function(e,t,a){},"2e12":function(e,t,a){},"312b":function(e,t,a){"use strict";var n=a("1e93"),r=a.n(n);r.a},"3c45":function(e,t,a){},"582e":function(e,t,a){},"588e":function(e,t,a){},"5c0b":function(e,t,a){"use strict";var n=a("9c0c"),r=a.n(n);r.a},6747:function(e,t,a){"use strict";var n=a("eada"),r=a.n(n);r.a},"6b63":function(e,t,a){},"6b90":function(e,t,a){"use strict";var n=a("582e"),r=a.n(n);r.a},"6bd7":function(e,t,a){"use strict";var n=a("ac00"),r=a.n(n);r.a},"853a":function(e,t,a){"use strict";var n=a("d4ee"),r=a.n(n);r.a},"9c0c":function(e,t,a){},ac00:function(e,t,a){},b2f6:function(e,t,a){"use strict";var n=a("2e12"),r=a.n(n);r.a},ccd1:function(e,t,a){"use strict";var n=a("2aca"),r=a.n(n);r.a},cd49:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n,r=a("2b0e"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("app-navbar",{attrs:{hide:e.appState.factoryFormOpen||e.appState.selectFactoryMode,fixed:!0},on:{menu:e.toggleSidebar}},[e._v("農地違章工廠舉報")]),a("app-sidebar",{model:{value:e.appState.sidebarOpen,callback:function(t){e.$set(e.appState,"sidebarOpen",t)},expression:"appState.sidebarOpen"}}),a("filter-modal",{attrs:{open:e.appState.filterModalOpen,dismiss:e.closeFilterModal}}),a("create-factory-success-modal",{attrs:{open:e.appState.createFactorySuccessModalOpen,dismiss:function(){return e.setCreateFactorySuccessModal(!1)}}}),a("Map",{attrs:{openCreateFactoryForm:e.openCreateFactoryForm,openEditFactoryForm:e.openEditFactoryForm,selectFactoryMode:e.appState.selectFactoryMode,enterSelectFactoryMode:e.enterSelectFactoryMode,exitSelectFactoryMode:e.exitSelectFactoryMode,setFactoryLocation:e.setFactoryLocation,openFilterModal:e.openFilterModal}}),e.appState.factoryFormOpen?a("form-page",{attrs:{mode:e.appState.formMode,factoryData:e.appState.factoryData,close:e.closeFactoryPage,selectFactoryMode:e.appState.selectFactoryMode,enterSelectFactoryMode:e.enterSelectFactoryMode,exitSelectFactoryMode:e.exitSelectFactoryMode,factoryLocation:e.appState.factoryLocation,setCreateFactorySuccessModal:e.setCreateFactorySuccessModal}}):e._e()],1)},i=[],c=a("750b"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.selectFactoryMode?a("div",{staticClass:"navbar-container"},[a("app-navbar",{attrs:{dark:!1,fixed:!0},on:{back:e.onNavBack}},[e._v(" 新增資訊 ")])],1):e._e(),a("div",{staticClass:"map-container"},[a("div",{ref:"root",staticClass:"map"}),a("div",{ref:"popup",class:["popup",{show:e.popupData.show}],style:{borderColor:e.popupData.color}},[a("div",{staticClass:"close",on:{click:function(t){e.popupData.show=!1}}}),a("h3",[e._v(e._s(e.popupData.name))]),a("p",{style:{color:e.popupData.color}},[e._v(e._s(e.popupData.status))]),a("app-button",{attrs:{outline:""},on:{click:e.onClickEditFactoryData}},[e._v(" 補充資料 ")])],1),a("div",{staticClass:"ol-map-search ol-unselectable ol-control",on:{click:e.openFilterModal}},[e._m(0)]),a("div",{staticClass:"ol-fit-location ol-unselectable ol-control",on:{click:e.zoomToGeolocation}},[e._m(1)]),e.selectFactoryMode?a("div",{staticClass:"center-point"}):e._e(),a("div",{staticClass:"factory-button-group"},[e.selectFactoryMode?e._e():a("div",{staticClass:"create-factory-button"},[a("app-button",{on:{click:e.onClickCreateFactoryButton}},[e._v("我要新增違建工廠")])],1),e.selectFactoryMode?a("div",{staticClass:"choose-location-button"},[a("app-button",{attrs:{disabled:!e.factoryValid},on:{click:e.onClickFinishSelectFactoryPositionButton}},[e._v(" 選擇此地點 ")])],1):e._e()])])])},l=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",[a("img",{attrs:{src:"/images/search.svg",alt:"search"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",[a("img",{attrs:{src:"/images/locate.svg",alt:"locate"}})])}],u=(a("d81d"),a("b0c0"),a("96cf"),a("e587")),p=a("9ab4"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{class:{outline:e.outline,disabled:e.disabled},on:{click:e.click}},[e._t("default")],2)},f=[],m=Object(c["b"])({name:"AppButton",props:{outline:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup:function(e,t){var a=function(){e.disabled||t.emit("click")};return{click:a}}}),v=m,y=(a("853a"),a("2877")),h=Object(y["a"])(v,d,f,!1,null,"087f99ed",null),g=h.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("nav",{class:{dark:e.dark,fixed:e.fixed,hide:e.hide}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.dark,expression:"!dark"}],staticClass:"back-button",on:{click:function(t){return e.onBackClick()}}},[a("span"),a("span"),a("span")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.dark,expression:"dark"}],staticClass:"back-placeholder"}),e._t("default"),a("div",{staticClass:"menu-button",on:{click:function(t){return e.onMenuClick()}}},[a("span"),a("span"),a("span")])],2)},F=[],w=Object(c["b"])({name:"AppNavbar",props:{dark:{type:Boolean,default:!0},fixed:{type:Boolean,default:!1},back:{type:Function},hide:{type:Boolean,default:!1}},setup:function(e,t){var a=t.emit;return{onBackClick:function(){a("back")},onMenuClick:function(){a("menu")}}}}),k=w,O=(a("6b90"),Object(y["a"])(k,b,F,!1,null,"b1a690de",null)),S=O.exports,x=(a("4de4"),a("4160"),a("caad"),a("13d5"),a("4ec9"),a("4fad"),a("d3b7"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),a("284c")),_=a("9f12"),M=a("53fe"),j=a("2fa7"),C=a("4cdf"),A=a("a2c7"),L=a("5eee"),E=a("6c77"),P=a("6cbf"),I=a("ce2c"),U=a("83a6"),T=a("8682"),R=a("82b0"),B=a("f403"),D=a("d510"),V=a("6ed8"),G=a("256f"),N=a("0af5"),$=a("3e6b"),q=a("480c"),z=a("5831"),X=a("d0e9"),J=a("e29f"),W=a("9d47"),H=a("f53f"),Z=a("3a39"),K=a("508e"),Y=(a("a630"),a("fb6a"),a("45fc"),window.OffscreenCanvas?new OffscreenCanvas(500,500):document.createElement("canvas")),Q=Y.getContext("2d"),ee=function(e){return function(t){return new Promise((function(a){var n=new Image;n.crossOrigin="",n.src=t,n.style.display="none",n.onload=function(){return Object(p["a"])(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Y.width=n.width,Y.height=n.height,Q.clearRect(0,0,Y.width,Y.height),Q.drawImage(n,0,0),r=Q.getImageData(0,0,n.width,n.height),o=r.data,t.next=8,Promise.resolve(e(o));case 8:i=document.createElement("canvas"),c=i.getContext("2d"),i.width=n.width,i.height=n.height,c.putImageData(r,0,0),a(i.toDataURL()),n.remove(),i.remove();case 16:case"end":return t.stop()}}),t)})))}}))}},te=(ee((function(e){for(var t=0;t<e.length;t+=4){var a=(e[t]+e[t+1]+e[t+2])/3;e[t]=a,e[t+1]=a,e[t+2]=a}})),[[255,241,0]]),ae=function(e,t){return!e.some((function(e,a){return t[a]!==e}))},ne=function(e){return te.some((function(t){return ae(t,e)}))},re=ee((function(e){for(var t=0;t<e.length;t+=4){var a=Array.from(e.slice(t,t+3));ne(a)?(e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=1):(e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=255)}})),oe=a("d202"),ie={D:"/images/marker-green.svg",F:"/images/marker-red.svg",A:"/images/marker-blue.svg"},ce={D:"#6D8538",F:"#A22929",A:"#447287"};(function(e){e[e["OSM"]=0]="OSM",e[e["TAIWAN"]=1]="TAIWAN",e[e["SATELITE"]=2]="SATELITE"})(n||(n={}));var se=function(){return Object.entries({zoomIn:"/images/zoom-in.svg",zoomOut:"/images/zoom-out.svg"}).reduce((function(e,t){var a=Object(u["a"])(t,2),n=a[0],r=a[1],o=document.createElement("img");return o.setAttribute("src",r),Object.assign(Object.assign({},e),Object(j["a"])({},n,o))}),{})},le=Object.entries(ie).reduce((function(e,t){var a=Object(u["a"])(t,2),n=a[0],r=a[1];return Object.assign(Object.assign({},e),Object(j["a"])({},n,new E["b"]({image:new P["a"]({anchorYUnits:R["a"].PIXELS,anchorOrigin:oe["a"].BOTTOM_LEFT,src:r})})))}),{}),ue=new E["b"]({}),pe=new E["b"]({image:new I["a"]({fill:new U["a"]({color:"#A22929"}),radius:12,stroke:new T["a"]({color:"#FFFFFF",width:1})})}),de=function(){function e(t){Object(_["a"])(this,e),this.appliedFilters=[],this.factoryMap=new Map,this._map=t}return Object(M["a"])(e,[{key:"getFactory",value:function(e){return this.factoryMap.get(e)}},{key:"updateFactory",value:function(e,t){this.factoryMap.set(e,t)}},{key:"addFactories",value:function(e){var t=this,a=this.createFactoryFeature.bind(this),n=e.filter((function(e){return!t.factoryMap.has(e.id)})).map(a);this.factoriesLayerSource.addFeatures(n)}},{key:"hideFactories",value:function(e){var t=this;e.forEach((function(e){var a=t.factoriesLayerSource.getFeatureById(e.id);a.setStyle(ue)}))}},{key:"setFactoryStatusFilter",value:function(e){if(this.appliedFilters=e,0===e.length)return this.displayAllFactory();this.updateFactoriesFeatureStyle()}},{key:"isFactoryVisible",value:function(e){return 0===this.appliedFilters.length||this.appliedFilters.includes(e.status)}},{key:"getFactoryStyle",value:function(e){var t=this.isFactoryVisible(e);return t?le[e.status]:ue}},{key:"createFactoryFeature",value:function(e){var t=new C["a"]({geometry:new B["a"](Object(G["i"])([e.lng,e.lat],"EPSG:4326","EPSG:3857"))});return t.setId(e.id),t.setStyle(this.getFactoryStyle(e)),this.factoryMap.set(e.id,e),t}},{key:"forEachFeatureFactory",value:function(e){var t=this;this.factoriesLayerSource.getFeatures().forEach((function(a){var n=a.getId(),r=t.factoryMap.get(n);e(a,r)}))}},{key:"displayAllFactory",value:function(){this.forEachFeatureFactory((function(e,t){e.setStyle(le[t.status])}))}},{key:"updateFactoriesFeatureStyle",value:function(){var e=this;this.forEachFeatureFactory((function(t,a){t.setStyle(e.getFactoryStyle(a))}))}},{key:"mapInstance",get:function(){return this._map}},{key:"factories",get:function(){return Object(x["a"])(this.factoryMap.values())}},{key:"factoriesLayerSource",get:function(){if(!this._factoriesLayerSource){this._factoriesLayerSource=new z["a"]({features:[]});var e=new $["a"]({source:this._factoriesLayerSource,zIndex:3});this.mapInstance.map.addLayer(e)}return this._factoriesLayerSource}}]),e}(),fe=function(){for(var e=Object(G["d"])("EPSG:3857"),t=e.getExtent(),a=new Array(21),n=Object(N["E"])(t)/256,r=new Array(21),o=0;o<21;++o)a[o]=n/Math.pow(2,o),r[o]=o;return new V["b"]({origin:Object(N["C"])(t),resolutions:a,matrixIds:r})},me=function(e,t){var a=function(){switch(e){case n.OSM:return new X["a"]({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'});case n.TAIWAN:return new D["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts",layer:"EMAP",tileGrid:t,crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});case n.SATELITE:return new D["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/PHOTO_MIX/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"EMAP",tileGrid:t,requestEncoding:"REST",crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});default:return new X["a"]({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'})}}();return new q["a"]({source:a,opacity:.6,zIndex:1})},ve=function(e){return new q["a"]({source:new D["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/nURBAN2/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"LUIMAP",requestEncoding:"REST",tileGrid:e,tileLoadFunction:function(e,t){var a=e.getImage();re(t).then((function(e){a.src=e}))},crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'}),opacity:.5,zIndex:2})},ye=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(_["a"])(this,e),this.tileGrid=fe(),this.mapDom=t,this.baseLayer=me(n.OSM,this.tileGrid),this._map=this.instantiateOLMap(this.mapDom,this.baseLayer,r),this.geolocation=this.setupGeolocationTracking(this._map),r.minimap||(this.geolocation=this.setupGeolocationTracking(this._map)),this.setupEventListeners(this._map,a)}return Object(M["a"])(e,[{key:"setupEventListeners",value:function(e,t){var a=this,n=function(){return Object(p["a"])(a,void 0,void 0,regeneratorRuntime.mark((function a(){var n,r,o,i,c,s,l,p,d,f,m,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e.getView(),r=n.getZoom(),o=n.getResolutionForZoom(r),i=Math.ceil(o),c=Object(G["i"])(n.getCenter(),"EPSG:3857","EPSG:4326"),s=Object(u["a"])(c,2),l=s[0],p=s[1],!t.onMoved){a.next=11;break}return d=this.mapDom.getBoundingClientRect(),f=d.width,m=d.height,a.next=9,this.canPlaceFactory([f/2,m/2]);case 9:v=a.sent,t.onMoved([l,p,i],v);case 11:case"end":return a.stop()}}),a,this)})))};e.on("change:resolution",n),e.on("moveend",n),e.on("click",(function(n){return Object(p["a"])(a,void 0,void 0,regeneratorRuntime.mark((function a(){var r,o,i,c,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.onClicked&&(r=Object(G["i"])(n.coordinate,"EPSG:3857","EPSG:4326"),o=Object(u["a"])(r,2),i=o[0],c=o[1],s=e.forEachFeatureAtPixel(n.pixel,(function(e){return e})),t.onClicked([i,c],s));case 1:case"end":return a.stop()}}),a)})))}))}},{key:"instantiateOLMap",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=fe(),r=new A["a"]({center:Object(G["i"])([120.1,23.234],"EPSG:4326","EPSG:3857"),zoom:16}),o=se(),i={target:e,layers:[t,ve(n)],view:r,controls:[new J["a"]({zoomInLabel:o.zoomIn,zoomOutLabel:o.zoomOut}),new W["a"]],interactions:Object(Z["a"])({pinchRotate:!1}).extend([new K["a"]({threshold:.4})])};return a.minimap&&(i.controls=[],i.interactions=[]),new L["a"](i)}},{key:"setupGeolocationTracking",value:function(e){var t=e.getView(),a=new H["a"]({trackingOptions:{enableHighAccuracy:!0},projection:t.getProjection()});a.setTracking(!0);var n=this.setupgeolocationLayer(a);return e.addLayer(n),a}},{key:"setupgeolocationLayer",value:function(e){var t=this,a=new C["a"];e.on("change:position",(function(){var t=e.getPosition();a.setGeometry(t?new B["a"](t):void 0)}));var n=!1;e.on("change",(function(){if(!n){var a=e.getPosition();a&&(t.zoomToGeolocation(),n=!0)}}));var r=new $["a"]({source:new z["a"]({features:[a]})});return r}},{key:"zoomToGeolocation",value:function(){if(this.geolocation){var e=this.geolocation.getPosition();if(e){var t=this._map.getView();t.setCenter(e),t.setZoom(16)}}}},{key:"changeBaseMap",value:function(e){this._map.removeLayer(this.baseLayer),this.baseLayer=me(e,this.tileGrid),this._map.addLayer(this.baseLayer)}},{key:"canPlaceFactory",value:function(e){var t=this;return new Promise((function(a){t._map.forEachLayerAtPixel(e,(function(e,t){var n=Object(u["a"])(t,4),r=n[3];return a(1===r)}),{layerFilter:function(e){return"LUIMAP"===e.getProperties().source.layer_}}),a(!1)}))}},{key:"getLUIMAPLayer",value:function(){var e=this;return new Promise((function(t,a){var n;e._map.getLayers().forEach((function(e){"LUIMAP"===e.getProperties().source.layer_&&(n=e,t(e))})),n||a(new TypeError("LUIMAP Layer not found"))}))}},{key:"setLUILayerVisible",value:function(e){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getLUIMAPLayer();case 2:a=t.sent,a.setVisible(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setMinimapPin",value:function(e,t){var a=Object(G["i"])([e,t],"EPSG:4326","EPSG:3857");if(this.minimapPinFeature)this.minimapPinFeature.setGeometry(new B["a"](a));else{var n=new C["a"]({geometry:new B["a"](a)});n.setStyle(pe),this.minimapPinFeature=n;var r=new z["a"]({features:[n]}),o=new $["a"]({source:r,zIndex:4});this.map.addLayer(o)}this._map.getView().setCenter(a)}},{key:"map",get:function(){return this._map}}]),e}();function he(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new ye(e,t);return window.changeBaseMap=a.changeBaseMap.bind(a),new de(a)}function ge(e,t){var a=new ye(e,{},{minimap:!0});return a.map.getView().setCenter(t),new de(a)}a("a4d3"),a("e01a"),a("d28b"),a("99af"),a("2b3d");var be=a("bc3a"),Fe=a.n(be),we="https://api.disfactory.tw/api",ke=Fe.a.create({baseURL:we,headers:{"Content-Type":"application/json"}});function Oe(e,t,a){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ke.get("/factories?range=".concat(e,"&lng=").concat(t,"&lat=").concat(a));case 3:return r=n.sent,o=r.data,n.abrupt("return",o);case 8:throw n.prev=8,n.t0=n["catch"](0),console.error(n.t0),new TypeError("Get factory failed");case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))}function Se(e){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,n,r,o,i,c,s,l,u,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=[],n=!0,r=!1,o=void 0,t.prev=4,i=e[Symbol.iterator]();case 6:if(n=(c=i.next()).done){t.next=18;break}return s=c.value,l=new FormData,l.append("image",s),t.next=12,ke.post("/images",l,{headers:{"Content-Type":"multipart/form-data"}});case 12:u=t.sent,p=u.data,a.push({token:p.token,src:URL.createObjectURL(s)});case 15:n=!0,t.next=6;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t["catch"](4),r=!0,o=t.t0;case 24:t.prev=24,t.prev=25,n||null==i.return||i.return();case 27:if(t.prev=27,!r){t.next=30;break}throw o;case 30:return t.finish(27);case 31:return t.finish(24);case 32:return t.abrupt("return",a);case 33:case"end":return t.stop()}}),t,null,[[4,20,24,32],[25,,27,31]])})))}function xe(e){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ke.post("/factories",JSON.stringify(e));case 3:return a=t.sent,n=a.data,t.abrupt("return",n);case 8:throw t.prev=8,t.t0=t["catch"](0),console.error(t.t0),new TypeError("Create factory failed");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))}function _e(e,t){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,ke.put("/factories/".concat(e),JSON.stringify(t));case 3:return n=a.sent,r=n.data,a.abrupt("return",r);case 8:throw a.prev=8,a.t0=a["catch"](0),console.error(a.t0),new TypeError("Update factory failed");case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))}var Me=Symbol("MAIN_MAP_CONTROLLER"),je=a("0710"),Ce=a("698f"),Ae={1:"金屬","2-1":"沖床、銑床、車床、鏜孔","2-2":"焊接、鑄造、熱處理","2-3":"金屬表面處理、噴漆",3:"塑膠加工、射出",4:"橡膠加工",5:"非金屬礦物（石材）",6:"食品",7:"皮革",8:"紡織",9:"其他"},Le={D:"已舉報",F:"資料不齊",A:"待審核"},Ee=Object(c["b"])({components:{AppButton:g,AppNavbar:S},props:{openCreateFactoryForm:{type:Function,required:!0},openEditFactoryForm:{type:Function,required:!0},selectFactoryMode:{type:Boolean,required:!0},enterSelectFactoryMode:{type:Function,required:!0},exitSelectFactoryMode:{type:Function,required:!0},setFactoryLocation:{type:Function,required:!0},openFilterModal:{type:Function,required:!0}},setup:function(e){var t=Object(c["h"])(null),a=Object(c["h"])(null),n=Object(c["h"])(!1),r=Object(c["h"])([]),o=Object(c["d"])(Me,Object(c["h"])()),i=Object(c["h"])({show:!1,id:"",name:"",color:"",status:""}),s=Object(c["h"])(null),l=function(e){if(o.value){var t=o.value.getFactory(e);t&&(i.value.id=t.id,i.value.name=t.name,i.value.color=ce[t.status],i.value.status=Le[t.status],i.value.show=!0,s.value=t)}},d=function(){s.value&&e.openEditFactoryForm(s.value)};function f(){o.value&&(o.value.mapInstance.setLUILayerVisible(!0),e.enterSelectFactoryMode(),i.value.show=!1)}function m(){o.value&&(o.value.mapInstance.setLUILayerVisible(!1),e.setFactoryLocation(r.value),e.exitSelectFactoryMode(),e.openCreateFactoryForm())}return Object(c["e"])((function(){var e=new je["a"]({element:a.value,positioning:Ce["a"].BOTTOM_LEFT}),c=he(t.value,{onMoved:function(e,t){var a=Object(u["a"])(e,3),o=a[0],i=a[1],s=a[2];return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.value=t,r.value=[o,i],e.prev=2,e.next=5,Oe(s,o,i);case 5:a=e.sent,Array.isArray(a)&&c.addFactories(a),e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](2);case 11:case"end":return e.stop()}}),e,null,[[2,9]])})))},onClicked:function(t,a){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a?(e.setPosition(a.getGeometry().getCoordinates()),l(a.getId())):i.value.show=!1;case 1:case"end":return t.stop()}}),t)})))}});c.mapInstance.map.addOverlay(e),o.value=c,c.mapInstance.setLUILayerVisible(!1)})),{root:t,popup:a,factoryValid:n,zoomToGeolocation:function(){o.value&&o.value.mapInstance.zoomToGeolocation()},onNavBack:function(){e.exitSelectFactoryMode()},popupData:i,onClickEditFactoryData:d,onClickCreateFactoryButton:f,onClickFinishSelectFactoryPositionButton:m}}}),Pe=Ee,Ie=(a("f42a"),Object(y["a"])(Pe,s,l,!1,null,"548913bc",null)),Ue=Ie.exports,Te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{base:!0,open:e.value}},[a("div",{class:{sidebar:!0,open:e.value}},[a("div",{staticClass:"close",on:{click:e.close}}),a("h1",[e._v("主選單")]),a("hr"),a("ul",e._l(e.links,(function(t,n){return a("li",{key:n},[a("a",{attrs:{href:t.href}},[e._v(e._s(t.text))])])})),0)])])},Re=[],Be=Object(c["b"])({name:"AppSidebar",props:{value:{type:Boolean,required:!0}},setup:function(e,t){var a=Object(c["h"])([{text:"使用教學",href:"#"},{text:"安全須知",href:"#"},{text:"聯絡我們",href:"#"},{text:"關於舉報系統",href:"#"}]),n=function(){t.emit("input",!1)};return{links:a,close:n}}}),De=Be,Ve=(a("b2f6"),Object(y["a"])(De,Te,Re,!1,null,"3d10907c",null)),Ge=Ve.exports,Ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-modal",{attrs:{open:e.open,dismiss:e.dismiss}},[a("div",{staticClass:"page"},[a("div",{staticClass:"page-inner"},[a("h2",{staticStyle:{"margin-right":"30px"}},[e._v("篩選")]),a("label",{staticClass:"checkbox-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.filterF,expression:"filterF"}],attrs:{type:"checkbox",name:"F"},domProps:{checked:Array.isArray(e.filterF)?e._i(e.filterF,null)>-1:e.filterF},on:{change:function(t){var a=e.filterF,n=t.target,r=!!n.checked;if(Array.isArray(a)){var o=null,i=e._i(a,o);n.checked?i<0&&(e.filterF=a.concat([o])):i>-1&&(e.filterF=a.slice(0,i).concat(a.slice(i+1)))}else e.filterF=r}}}),a("span",{staticClass:"checkbox"}),a("span",{staticClass:"data-type"},[e._v("資料不全")]),a("span",{staticClass:"line"}),a("img",{attrs:{src:"/images/marker-red.svg"}})]),a("label",{staticClass:"checkbox-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.filterA,expression:"filterA"}],attrs:{type:"checkbox",name:"A"},domProps:{checked:Array.isArray(e.filterA)?e._i(e.filterA,null)>-1:e.filterA},on:{change:function(t){var a=e.filterA,n=t.target,r=!!n.checked;if(Array.isArray(a)){var o=null,i=e._i(a,o);n.checked?i<0&&(e.filterA=a.concat([o])):i>-1&&(e.filterA=a.slice(0,i).concat(a.slice(i+1)))}else e.filterA=r}}}),a("span",{staticClass:"checkbox"}),a("span",{staticClass:"data-type"},[e._v("資料齊全")]),a("span",{staticClass:"line"}),a("img",{attrs:{src:"/images/marker-blue.svg"}})]),a("label",{staticClass:"checkbox-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.filterD,expression:"filterD"}],attrs:{type:"checkbox",name:"D"},domProps:{checked:Array.isArray(e.filterD)?e._i(e.filterD,null)>-1:e.filterD},on:{change:function(t){var a=e.filterD,n=t.target,r=!!n.checked;if(Array.isArray(a)){var o=null,i=e._i(a,o);n.checked?i<0&&(e.filterD=a.concat([o])):i>-1&&(e.filterD=a.slice(0,i).concat(a.slice(i+1)))}else e.filterD=r}}}),a("span",{staticClass:"checkbox"}),a("span",{staticClass:"data-type"},[e._v("已舉報")]),a("span",{staticClass:"line"}),a("img",{attrs:{src:"/images/marker-green.svg"}})])]),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("app-button",{on:{click:function(t){return e.onClick()}}},[e._v("確認")])],1)])])},$e=[],qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-modal-component",class:{open:e.open}},[a("div",{staticClass:"app-modal-backdrop",on:{click:e.dismiss}}),a("div",{staticClass:"app-modal"},[e.showCloseButon?a("div",{staticClass:"close",on:{click:e.dismiss}}):e._e(),e._t("default")],2)])},ze=[],Xe=Object(c["b"])({name:"AppModal",props:{open:{type:Boolean,default:!1},dismiss:{type:Function},showCloseButon:{type:Boolean,default:!0}}}),Je=Xe,We=(a("6747"),Object(y["a"])(Je,qe,ze,!1,null,"018980e4",null)),He=We.exports,Ze=Object(c["b"])({name:"FilterModal",components:{AppModal:He,AppButton:g},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(e){var t=Object(c["h"])(!1),a=Object(c["h"])(!1),n=Object(c["h"])(!1),r=Object(c["d"])(Me,Object(c["h"])());return{filterF:t,filterA:a,filterD:n,onClick:function(){r.value&&(r.value.setFactoryStatusFilter([!!t.value&&"F",!!a.value&&"A",!!n.value&&"D"].filter(Boolean)),"function"===typeof e.dismiss&&e.dismiss())}}}}),Ke=Ze,Ye=(a("e6af"),Object(y["a"])(Ke,Ne,$e,!1,null,"545e847f",null)),Qe=Ye.exports,et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-modal",{attrs:{open:e.open,dismiss:e.dismiss,showCloseButon:!1}},[a("h3",[e._v("感謝您新增資訊！")]),a("app-button",{on:{click:e.dismiss}},[e._v("確認")])],1)},tt=[],at=Object(c["b"])({name:"CreateFactorySuccessModal",components:{AppModal:He,AppButton:g},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),nt=at,rt=(a("ccd1"),Object(y["a"])(nt,et,tt,!1,null,"3436fde9",null)),ot=rt.exports,it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"navbar-container"},[a("app-navbar",{attrs:{dark:!1,fixed:!0},on:{back:e.onNavBack}},[e._v(" "+e._s(e.isCreateMode?"新增資訊":"補充資訊")+" ")])],1),a("div",{staticClass:"page-container",class:{hide:e.selectFactoryMode}},[a("image-upload-modal",{attrs:{open:e.formPageState.imageUploadModalOpen,dismiss:e.closeImageUploadModal,images:e.imagesToUpload,finishImagesUpload:e.finishImagesUpload,finishUploaderForm:e.finishUploaderForm}}),a("div",{staticClass:"page",staticStyle:{padding:"29px 35px"}},[a("h1",[e._v(" "+e._s(e.isCreateMode?"輸入資訊":"輸入補充資訊")+" ")]),a("h3",[e._v("工廠地點")]),a("div",{ref:"minimap",staticClass:"minimap",on:{click:function(t){return e.onClickMinimap()}}}),a("div",{staticClass:"flex justify-between",staticStyle:{"margin-top":"40px","margin-bottom":"20px"}},[e._m(0),a("div",[a("label",[a("input",{ref:"image",staticStyle:{visibility:"hidden",position:"absolute","pointer-events":"none",left:"-1000px"},attrs:{multiple:"",type:"file",accept:"image/*"},on:{change:e.handleImagesUpload}}),e.isiOS||e.isSafari?a("app-button",{attrs:{disabled:!e.isCreateMode}},[e._v("新增")]):a("app-button",{attrs:{disabled:!e.isCreateMode},on:{click:e.onClickImageUpload}},[e._v("新增")])],1)])]),a("div",{staticClass:"images-grid"},e._l(e.factoryFormState.imageUrls,(function(e){return a("div",{key:e,staticClass:"image-card"},[a("img",{attrs:{src:e}})])})),0),a("h3",[e._v("工廠名稱")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-text-field",{attrs:{placeholder:"請輸入工廠名稱"},model:{value:e.factoryFormState.name,callback:function(t){e.$set(e.factoryFormState,"name",t)},expression:"factoryFormState.name"}})],1),e.isEditMode?a("div",{staticStyle:{width:"100px"}},[a("app-button",{on:{click:function(t){return e.updateFactoryFieldsFor("name",e.factoryName)}}},[e._v("確認")])],1):e._e()]),a("h3",[e._v("工廠類型")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-select",{attrs:{items:e.factoryTypeItems},model:{value:e.factoryFormState.type,callback:function(t){e.$set(e.factoryFormState,"type",t)},expression:"factoryFormState.type"}})],1),e.isEditMode?a("div",{staticStyle:{width:"100px"}},[a("app-button",{on:{click:function(t){return e.updateFactoryFieldsFor("factory_type",e.factoryType)}}},[e._v("確認")])],1):e._e()]),a("h3",[e._v("新增其它資訊")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-text-field",{attrs:{placeholder:"請填入其他資訊，如聲音、氣味等等。"},model:{value:e.factoryFormState.others,callback:function(t){e.$set(e.factoryFormState,"others",t)},expression:"factoryFormState.others"}})],1),e.isEditMode?a("div",{staticStyle:{width:"100px"}},[a("app-button",{on:{click:function(t){return e.updateFactoryFieldsFor("others",e.factoryDescription)}}},[e._v("確認")])],1):e._e()]),e.isCreateMode?a("div",{staticClass:"text-center width-auto",staticStyle:{"margin-top":"60px"}},[a("app-button",{attrs:{disabled:!e.formPageState.valid||e.formPageState.submitting},on:{click:function(t){return e.submitFactory()}}},[e._v(" "+e._s(e.formPageState.submitting?"上傳資料中":"送出")+" ")])],1):e._e()])],1)])},ct=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex flex-column flex-auto"},[a("h3",{staticStyle:{"margin-top":"0"}},[e._v("工廠照片*")]),a("label",[a("small",[e._v("請上傳至少一張照片")])])])}],st=function(){var e=this,t=e.$createElement,a=e._self._c||t;return"checkbox"===e.type?a("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.inputValue)?e._i(e.inputValue,null)>-1:e.inputValue},on:{change:function(t){var a=e.inputValue,n=t.target,r=!!n.checked;if(Array.isArray(a)){var o=null,i=e._i(a,o);n.checked?i<0&&(e.inputValue=a.concat([o])):i>-1&&(e.inputValue=a.slice(0,i).concat(a.slice(i+1)))}else e.inputValue=r}}},"input",e.$attrs,!1)):"radio"===e.type?a("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:"radio"},domProps:{checked:e._q(e.inputValue,null)},on:{change:function(t){e.inputValue=null}}},"input",e.$attrs,!1)):a("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:e.type},domProps:{value:e.inputValue},on:{input:function(t){t.target.composing||(e.inputValue=t.target.value)}}},"input",e.$attrs,!1))},lt=[],ut=Object(c["b"])({name:"AppTextField",props:{type:{type:String,default:"text"},value:{type:String,required:!0}},setup:function(e,t){var a=Object(c["a"])({get:function(){return e.value},set:function(e){return t.emit("input",e)}});return{inputValue:a}}}),pt=ut,dt=(a("6bd7"),Object(y["a"])(pt,st,lt,!1,null,"1dc8b942",null)),ft=dt.exports,mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"select"},[a("select",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.inputValue=t.target.multiple?a:a[0]}}},"select",e.$attrs,!1),e._l(e.items,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[e._v(" "+e._s(t.text)+" ")])})),0)])},vt=[],yt=Object(c["b"])({name:"AppSelect",props:{value:{type:null,required:!0},items:{type:Array,required:!0}},setup:function(e,t){var a=Object(c["a"])({get:function(){return e.value},set:function(e){return t.emit("input",e)}});return{inputValue:a}}}),ht=yt,gt=(a("312b"),Object(y["a"])(ht,mt,vt,!1,null,"4f226c2f",null)),bt=gt.exports,Ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-modal",{staticClass:"page",attrs:{open:e.open,dismiss:e.closeModal}},[a("h2",[e._v("工廠照片")]),a("div",{staticClass:"images-grid"},e._l(e.imageUrls,(function(e){return a("div",{key:e,staticClass:"image-card"},[a("img",{attrs:{src:e}})])})),0),a("h2",[e._v(" 聯絡資訊（非必填）"),a("br"),a("small",{staticStyle:{"font-size":"14px"}},[e._v("如果對於照片有疑問，我們會透過您提供的資訊聯絡你。")])]),a("h3",[e._v("稱呼")]),a("app-text-field",{attrs:{placeholder:"例：林先生"},model:{value:e.formState.nickname,callback:function(t){e.$set(e.formState,"nickname",t)},expression:"formState.nickname"}}),a("h3",[e._v("聯絡資料")]),a("app-text-field",{attrs:{placeholder:"例：0912345678"},model:{value:e.formState.contact,callback:function(t){e.$set(e.formState,"contact",t)},expression:"formState.contact"}}),a("div",{staticStyle:{"margin-top":"35px"}},[a("app-button",{attrs:{disabled:e.formState.uploading},on:{click:function(t){return e.handleImagesUpload()}}},[e._v(" "+e._s(e.formState.uploading?"上傳中":"上傳照片")+" ")])],1)],1)},wt=[],kt=Object(c["b"])({name:"FilterModal",components:{AppModal:He,AppButton:g,AppTextField:ft},props:{open:{type:Boolean,default:!1},dismiss:{type:Function,required:!0},images:{type:FileList},finishImagesUpload:{type:Function,required:!0},finishUploaderForm:{type:Function,required:!0}},setup:function(e){var t=Object(c["g"])({nickname:"",contact:"",uploading:!1}),a=Object(c["a"])((function(){for(var t=[],a=0;a<e.images.length;a++)t.push(URL.createObjectURL(e.images[a]));return t}));return{formState:t,imageUrls:a,handleImagesUpload:function(){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.uploading=!0,n.prev=1,n.next=4,Se(e.images);case 4:r=n.sent,t.uploading=!1,e.finishImagesUpload(r,a),e.finishUploaderForm(t.nickname,t.contact),e.dismiss(),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](1),t.uploading=!1,console.error(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))},closeModal:function(){t.uploading||(e.finishImagesUpload([]),e.finishUploaderForm("",""),e.dismiss())}}}}),Ot=kt,St=(a("ea0b"),Object(y["a"])(Ot,Ft,wt,!1,null,"9feb4ff8",null)),xt=St.exports,_t=(a("0d03"),a("ac1f"),a("25f0"),a("466d"),!(!navigator.userAgent.match(/(iPod|iPhone|iPad)/)||!navigator.userAgent.match(/AppleWebKit/))),Mt=/constructor/i.test(window.HTMLElement)||function(e){return"[object SafariRemoteNotification]"===e.toString()}(!window.safari||"undefined"!==typeof window.safari&&window.safari.pushNotification),jt=Object(c["b"])({name:"FormPage",components:{AppButton:g,AppTextField:ft,AppSelect:bt,AppNavbar:S,ImageUploadModal:xt},props:{close:{type:Function,required:!0},selectFactoryMode:{type:Boolean,required:!0},enterSelectFactoryMode:{type:Function,required:!0},exitSelectFactoryMode:{type:Function,required:!0},factoryLocation:{type:Array,required:!0},setCreateFactorySuccessModal:{type:Function,required:!0},mode:{type:String,required:!0,defaultValue:"create"},factoryData:{type:Object,required:!0}},setup:function(e){var t,a=this,n=Object(c["d"])(Me,Object(c["h"])()),r="edit"===e.mode,o="create"===e.mode,i=[{text:"請選擇工廠類型",value:"0"}].concat(Object(x["a"])(Object.entries(Ae).map((function(e){var t=Object(u["a"])(e,2),a=t[0],n=t[1];return{text:n,value:a}})))),s={name:"",others:"",type:"0",lng:0,lat:0,images:[],imageUrls:[],nickname:"",contact:""};if(r){var l=e.factoryData;s.name=l.name,s.type=l.factory_type,s.others=l.others,s.images=l.images,s.lng=l.lng,s.lat=l.lat}var d=Object(c["g"])(s),f=Object(c["g"])({imageUploadModalOpen:!1,valid:!1,submitting:!1});Object(c["i"])((function(){var e=d.name,t=d.others,a=d.type,n=d.images,r=e&&t&&e.length>0&&t.length>0,o="0"!==a,i=n.length>0;f.valid=!!(r&&o&&i)}));var m=function(){f.imageUploadModalOpen=!1},v=function(){f.imageUploadModalOpen=!0},y=Object(c["h"])([]),h=Object(c["h"])(null),g=function(e,t){d.nickname=e,d.contact=t},b=function(t,o){return Object(p["a"])(a,void 0,void 0,regeneratorRuntime.mark((function a(){var i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=e.factoryData,r&&i){a.next=3;break}return a.abrupt("return");case 3:return a.prev=3,a.next=6,_e(i.id,Object(j["a"])({},t,o));case 6:c=a.sent,n.value&&n.value.updateFactory(i.id,c),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](3),console.error(a.t0);case 13:case"end":return a.stop()}}),a,null,[[3,10]])})))},F=Object(c["h"])(null);return Object(c["e"])((function(){if(n.value){var a=n.value,i=a.mapInstance.map.getView().getCenter();if(t=ge(F.value,i),t.addFactories(a.factories),r){var c=e.factoryData;t.mapInstance.setMinimapPin(c.lng,c.lat)}else if(o){var s=Object(u["a"])(e.factoryLocation,2),l=s[0],p=s[1];t.mapInstance.setMinimapPin(l,p)}}})),Object(c["i"])((function(){return e.factoryLocation}),(function(){if(o&&t){var a=Object(u["a"])(e.factoryLocation,2),n=a[0],r=a[1];t.mapInstance.setMinimapPin(n,r)}})),{minimap:F,onClickMinimap:function(){o&&n.value&&(n.value.mapInstance.setLUILayerVisible(!0),e.enterSelectFactoryMode())},factoryFormState:d,formPageState:f,factoryTypeItems:i,containerStyle:{width:"100%"},openImageUploadModal:v,closeImageUploadModal:m,imagesToUpload:y,image:h,isiOS:_t,isSafari:Mt,onClickImageUpload:function(){h.value.click()},handleImagesUpload:function(e){y.value=e.target.files,v()},finishImagesUpload:function(e,t){d.imageUrls=t,d.images=e.map((function(e){return e.token}))},onNavBack:function(){n.value&&(n.value.mapInstance.setLUILayerVisible(!1),e.close(),e.exitSelectFactoryMode())},submitFactory:function(){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,r,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return f.submitting=!0,t.prev=1,a=Object(u["a"])(e.factoryLocation,2),r=a[0],o=a[1],i={name:d.name,others:d.others,type:d.type,lng:r,lat:o,images:d.images,nickname:d.nickname,contact:d.contact},t.next=6,xe(i);case 6:c=t.sent,n.value&&n.value.addFactories([c]),t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](1);case 12:return t.prev=12,f.submitting=!1,t.finish(12);case 15:e.close(),e.exitSelectFactoryMode(),e.setCreateFactorySuccessModal(!0);case 18:case"end":return t.stop()}}),t,null,[[1,10,12,15]])})))},finishUploaderForm:g,isEditMode:r,isCreateMode:o,updateFactoryFieldsFor:b}}}),Ct=jt,At=(a("d6f7"),Object(y["a"])(Ct,it,ct,!1,null,"09cb3316",null)),Lt=At.exports,Et=Object(c["b"])({name:"App",components:{Map:Ue,AppButton:g,AppNavbar:S,AppSidebar:Ge,FilterModal:Qe,CreateFactorySuccessModal:ot,FormPage:Lt},setup:function(){var e=Object(c["g"])({sidebarOpen:!1,filterModalOpen:!1,createFactorySuccessModalOpen:!1,formMode:"create",factoryFormOpen:!1,factoryData:null,factoryLocation:[],selectFactoryMode:!1}),t=function(){e.sidebarOpen=!e.sidebarOpen};function a(){e.filterModalOpen=!1}function n(){e.filterModalOpen=!0}function r(t){e.createFactorySuccessModalOpen=t}var o=function(){e.factoryData=null,e.formMode="create",e.factoryFormOpen=!0},i=function(t){e.factoryData=t,e.formMode="edit",e.factoryFormOpen=!0};function s(){e.factoryFormOpen=!1}var l=function(t){e.factoryLocation=t};function u(){e.selectFactoryMode=!0}function p(){e.selectFactoryMode=!1}return Object(c["f"])(Me,Object(c["h"])(null)),{appState:e,toggleSidebar:t,openFilterModal:n,closeFilterModal:a,setCreateFactorySuccessModal:r,openCreateFactoryForm:o,openEditFactoryForm:i,closeFactoryPage:s,enterSelectFactoryMode:u,exitSelectFactoryMode:p,setFactoryLocation:l}}}),Pt=Et,It=(a("5c0b"),Object(y["a"])(Pt,o,i,!1,null,null,null)),Ut=It.exports;r["a"].config.productionTip=!1,r["a"].use(c["c"]),new r["a"]({render:function(e){return e(Ut)}}).$mount("#app")},d4ee:function(e,t,a){},d6f7:function(e,t,a){"use strict";var n=a("0a7e"),r=a.n(n);r.a},e6af:function(e,t,a){"use strict";var n=a("6b63"),r=a.n(n);r.a},ea0b:function(e,t,a){"use strict";var n=a("3c45"),r=a.n(n);r.a},eada:function(e,t,a){},f42a:function(e,t,a){"use strict";var n=a("588e"),r=a.n(n);r.a}});
//# sourceMappingURL=app.92f975ff.js.map