(function(e){function t(t){for(var r,c,o=t[0],u=t[1],l=t[2],f=0,p=[];f<o.length;f++)c=o[f],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&p.push(a[c][0]),a[c]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);s&&s(t);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var s=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},1048:function(e,t,n){},"39a1":function(e,t,n){"use strict";var r=n("9834"),a=n.n(r);a.a},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),a=n.n(r);a.a},"68f1":function(e,t,n){"use strict";var r=n("eb1f"),a=n.n(r);a.a},"6be6":function(e,t,n){"use strict";var r=n("9959"),a=n.n(r);a.a},9834:function(e,t,n){},9959:function(e,t,n){},"9c0c":function(e,t,n){},ab47:function(e,t,n){"use strict";var r=n("1048"),a=n.n(r);a.a},aec9:function(e,t,n){},b22f:function(e,t,n){"use strict";var r=n("b600"),a=n.n(r);a.a},b600:function(e,t,n){},ca8c:function(e,t,n){"use strict";var r=n("aec9"),a=n.n(r);a.a},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("app-navbar",[e._v("農地違章工廠舉報")]),n("filter-modal",{attrs:{open:e.filterModalOpen,dismiss:e.closeFilterModal}}),n("OSM"),n("app-text-field",{attrs:{placeholder:"請輸入工廠名稱"},model:{value:e.factoryName,callback:function(t){e.factoryName=t},expression:"factoryName"}}),n("app-select",{attrs:{items:e.factoryTypeItems},model:{value:e.factoryType,callback:function(t){e.factoryType=t},expression:"factoryType"}})],1)},c=[],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"root",staticClass:"map"})},u=[],l=n("750b"),s=(n("5bc0"),n("99af"),n("4de4"),n("4160"),n("caad"),n("d81d"),n("13d5"),n("4ec9"),n("4fad"),n("d3b7"),n("2532"),n("3ca3"),n("159b"),n("ddb0"),n("96cf"),n("2fa7")),f=n("e587"),p=n("9ab4"),d=n("6c77"),v=n("6cbf"),m=n("82b0"),b=n("4cdf"),y=n("5eee"),g=n("a2c7"),h=n("f403"),w=n("d510"),O=n("6ed8"),A=n("256f"),_=n("0af5"),j=n("3e6b"),x=n("480c"),k=n("5831"),P=(n("a630"),n("fb6a"),n("45fc"),window.OffscreenCanvas?new OffscreenCanvas(500,500):document.createElement("canvas")),S=P.getContext("2d"),F=function(e){return function(t){return new Promise((function(n){var r=new Image;r.crossOrigin="",r.src=t,r.style.display="none",r.onload=function(){return Object(p["a"])(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var a,i,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return P.width=r.width,P.height=r.height,S.clearRect(0,0,P.width,P.height),S.drawImage(r,0,0),a=S.getImageData(0,0,r.width,r.height),i=a.data,t.next=8,Promise.resolve(e(i));case 8:c=document.createElement("canvas"),o=c.getContext("2d"),c.width=r.width,c.height=r.height,o.putImageData(a,0,0),n(c.toDataURL()),r.remove(),c.remove();case 16:case"end":return t.stop()}}),t)})))}}))}},E=(F((function(e){for(var t=0;t<e.length;t+=4){var n=(e[t]+e[t+1]+e[t+2])/3;e[t]=n,e[t+1]=n,e[t+2]=n}})),[[152,230,0],[209,255,115],[171,220,97],[110,221,97],[233,255,190],[198,230,150],[56,204,61],[200,205,56],[126,237,39],[99,192,59],[170,192,60],[142,169,68],[138,255,218],[159,177,105],[112,134,79],[147,203,62],[168,168,0],[107,144,75],[77,101,57]]),M=function(e,t){return!e.some((function(e,n){return t[n]!==e}))},V=function(e){return E.some((function(t){return M(t,e)}))},C=F((function(e){for(var t=0;t<e.length;t+=4){var n=Array.from(e.slice(t,t+3));V(n)?(e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=0):(e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=255)}})),D=new Map,T={D:"/images/marker-green.svg",F:"/images/marker-red.svg",A:"/images/marker-blue.svg"},I=Object.entries(T).reduce((function(e,t){var n=Object(f["a"])(t,2),r=n[0],a=n[1];return Object.assign(Object.assign({},e),Object(s["a"])({},r,new d["b"]({image:new v["a"]({anchorYUnits:m["a"].PIXELS,src:a})})))}),{}),N=new d["b"]({}),$=[];function G(e){return 0===$.length||$.includes(e.status)}function R(e){var t=G(e);return t?I[e.status]:N}function B(e){var t=new b["a"]({geometry:new h["a"](Object(A["g"])([e.lng,e.lat],"EPSG:4326","EPSG:3857"))});return t.setId(e.id),t.setStyle(R(e)),D.set(e.id,e),t}function L(e,t){var n=t.filter((function(e){return!D.has(e.id)})).map(B);if(r)r.addFeatures(n);else{r=new k["a"]({features:n});var a=new j["a"]({source:r});e.addLayer(a)}}function q(e){r.getFeatures().forEach((function(t){var n=t.getId(),r=D.get(n);e(t,r)}))}function U(){q((function(e,t){e.setStyle(I[t.status])}))}function X(){q((function(e,t){e.setStyle(R(t))}))}function J(e){if(r){if($=e,0===e.length)return U();X()}}window.setFactoryStatusFilter=J;var Z,z=function(){for(var e=Object(A["d"])("EPSG:3857"),t=e.getExtent(),n=new Array(20),r=Object(_["E"])(t)/256,a=new Array(20),i=0;i<20;++i)n[i]=r/Math.pow(2,i),a[i]=i;return new O["b"]({origin:Object(_["C"])(t),resolutions:n,matrixIds:a})},Y=function(e){return new x["a"]({source:new w["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts",layer:"EMAP",tileGrid:e,crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'}),opacity:.5})},H=function(e){return new x["a"]({source:new w["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/LUIMAP/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}",layer:"LUIMAP",requestEncoding:"REST",tileGrid:e,tileLoadFunction:function(e,t){var n=e.getImage();C(t).then((function(e){n.src=e}))},crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'}),opacity:.5})};function K(e){var t=z();Z=new y["a"]({target:e,layers:[Y(t),H(t)],view:new g["a"]({center:Object(A["g"])([120.1,23.234],"EPSG:4326","EPSG:3857"),zoom:15})}),Z.on("click",(function(e){Z.forEachLayerAtPixel(e.pixel,(function(e,t){var n=Object(f["a"])(t,4),r=n[0],a=n[1],i=n[2],c=n[3];console.log("rgba(".concat(r,", ").concat(a,", ").concat(i,", ").concat(c,")"))}),{layerFilter:function(e){return"LUIMAP"===e.getProperties().source.layer_}})})),Z.on("moveend",(function(){return Object(p["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,a,i,c,o,u,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Z.getView(),n=t.getZoom(),r=t.getResolutionForZoom(n),a=Math.ceil(r),i=Object(A["g"])(t.getCenter(),"EPSG:3857","EPSG:4326"),c=Object(f["a"])(i,2),o=c[0],u=c[1],e.next=7,fetch("/server/api/factories?range=".concat(a,"&lng=").concat(o,"&lat=").concat(u));case 7:return l=e.sent,e.next=10,l.json();case 10:s=e.sent,L(Z,s);case 12:case"end":return e.stop()}}),e)})))})),window.map=Z}var Q=Object(l["b"])({setup:function(){var e=Object(l["e"])(null);return Object(l["d"])((function(){K(e.value)})),{root:e}}}),W=Q,ee=(n("ab47"),n("2877")),te=Object(ee["a"])(W,o,u,!1,null,"39659d34",null),ne=te.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{class:{outline:e.outline},on:{click:e.click}},[e._t("default")],2)},ae=[],ie=Object(l["b"])({name:"AppButton",props:{outline:{type:Boolean,default:!1}},setup:function(e,t){var n=function(){t.emit("click")};return{click:n}}}),ce=ie,oe=(n("6be6"),Object(ee["a"])(ce,re,ae,!1,null,"444f94d3",null)),ue=oe.exports,le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return"checkbox"===e.type?n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.inputValue)?e._i(e.inputValue,null)>-1:e.inputValue},on:{change:function(t){var n=e.inputValue,r=t.target,a=!!r.checked;if(Array.isArray(n)){var i=null,c=e._i(n,i);r.checked?c<0&&(e.inputValue=n.concat([i])):c>-1&&(e.inputValue=n.slice(0,c).concat(n.slice(c+1)))}else e.inputValue=a}}},"input",e.$attrs,!1)):"radio"===e.type?n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:"radio"},domProps:{checked:e._q(e.inputValue,null)},on:{change:function(t){e.inputValue=null}}},"input",e.$attrs,!1)):n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:e.type},domProps:{value:e.inputValue},on:{input:function(t){t.target.composing||(e.inputValue=t.target.value)}}},"input",e.$attrs,!1))},se=[],fe=Object(l["b"])({name:"AppTextField",props:{type:{type:String,default:"text"},value:{type:String,required:!0}},setup:function(e,t){var n=Object(l["a"])({get:function(){return e.value},set:function(e){return t.emit("input",e)}});return{inputValue:n}}}),pe=fe,de=(n("b22f"),Object(ee["a"])(pe,le,se,!1,null,"8ff0e738",null)),ve=de.exports,me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"select"},[n("select",e._b({directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.inputValue=t.target.multiple?n:n[0]}}},"select",e.$attrs,!1),e._l(e.items,(function(t){return n("option",{key:t.value,domProps:{value:t.value}},[e._v(" "+e._s(t.text)+" ")])})),0)])},be=[],ye=Object(l["b"])({name:"AppSelect",props:{value:{type:null,required:!0},items:{type:Array,required:!0}},setup:function(e,t){var n=Object(l["a"])({get:function(){return e.value},set:function(e){return t.emit("input",e)}});return{inputValue:n}}}),ge=ye,he=(n("ca8c"),Object(ee["a"])(ge,me,be,!1,null,"6fad94c0",null)),we=he.exports,Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",{class:{dark:e.dark}},[e._t("default")],2)},Ae=[],_e=Object(l["b"])({name:"AppNavbar",props:{onMenuClick:{type:Function},dark:{type:Boolean,default:!0}}}),je=_e,xe=(n("39a1"),Object(ee["a"])(je,Oe,Ae,!1,null,"f1dc02fe",null)),ke=xe.exports,Pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-modal",{attrs:{open:e.open,dismiss:e.dismiss}},[n("h1",[e._v("篩選")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.filterF,expression:"filterF"}],attrs:{type:"checkbox",name:"F"},domProps:{checked:Array.isArray(e.filterF)?e._i(e.filterF,null)>-1:e.filterF},on:{change:function(t){var n=e.filterF,r=t.target,a=!!r.checked;if(Array.isArray(n)){var i=null,c=e._i(n,i);r.checked?c<0&&(e.filterF=n.concat([i])):c>-1&&(e.filterF=n.slice(0,c).concat(n.slice(c+1)))}else e.filterF=a}}}),e._v(" 資料不全 ")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.filterA,expression:"filterA"}],attrs:{type:"checkbox",name:"A"},domProps:{checked:Array.isArray(e.filterA)?e._i(e.filterA,null)>-1:e.filterA},on:{change:function(t){var n=e.filterA,r=t.target,a=!!r.checked;if(Array.isArray(n)){var i=null,c=e._i(n,i);r.checked?c<0&&(e.filterA=n.concat([i])):c>-1&&(e.filterA=n.slice(0,c).concat(n.slice(c+1)))}else e.filterA=a}}}),e._v(" 資料齊全 ")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.filterD,expression:"filterD"}],attrs:{type:"checkbox",name:"D"},domProps:{checked:Array.isArray(e.filterD)?e._i(e.filterD,null)>-1:e.filterD},on:{change:function(t){var n=e.filterD,r=t.target,a=!!r.checked;if(Array.isArray(n)){var i=null,c=e._i(n,i);r.checked?c<0&&(e.filterD=n.concat([i])):c>-1&&(e.filterD=n.slice(0,c).concat(n.slice(c+1)))}else e.filterD=a}}}),e._v(" 已舉報 ")]),n("app-button",{on:{click:function(t){return e.onClick()}}},[e._v("確認")])],1)},Se=[],Fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-modal-component",class:{open:e.open}},[n("div",{staticClass:"app-modal-backdrop",on:{click:e.dismiss}}),n("div",{staticClass:"app-modal"},[n("div",{staticClass:"close"}),e._t("default")],2)])},Ee=[],Me=Object(l["b"])({name:"AppModal",props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Ve=Me,Ce=(n("68f1"),Object(ee["a"])(Ve,Fe,Ee,!1,null,"b9a7dd5a",null)),De=Ce.exports,Te=Object(l["b"])({name:"FilterModal",components:{AppModal:De,AppButton:ue},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(e,t){var n=Object(l["e"])(!1),r=Object(l["e"])(!1),a=Object(l["e"])(!1);return{filterF:n,filterA:r,filterD:a,onClick:function(){J([!!n.value&&"F",!!r.value&&"A",!!a.value&&"D"].filter(Boolean)),"function"===typeof e.dismiss&&e.dismiss()}}}}),Ie=Te,Ne=Object(ee["a"])(Ie,Pe,Se,!1,null,null,null),$e=Ne.exports,Ge=Object(l["b"])({name:"App",components:{OSM:ne,AppButton:ue,AppTextField:ve,AppSelect:we,AppNavbar:ke,FilterModal:$e},setup:function(){var e=Object(l["e"])(""),t=Object(l["e"])(0),n=[{text:"請選擇工廠類型",value:0},{text:"高危險",value:1},{text:"低危險",value:2}],r=Object(l["e"])(!1),a=function(){r.value=!1};return{factoryName:e,factoryType:t,factoryTypeItems:n,filterModalOpen:r,closeFilterModal:a}}}),Re=Ge,Be=(n("5c0b"),Object(ee["a"])(Re,i,c,!1,null,null,null)),Le=Be.exports;a["a"].config.productionTip=!1,a["a"].use(l["c"]),new a["a"]({render:function(e){return e(Le)}}).$mount("#app")},eb1f:function(e,t,n){}});
//# sourceMappingURL=app.f3758f79.js.map