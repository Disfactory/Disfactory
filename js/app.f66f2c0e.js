(function(t){function e(e){for(var o,i,s=e[0],c=e[1],l=e[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&p.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(p.length)p.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],o=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var o={},n={app:0},r=[];function i(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=o,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(a,o,function(e){return t[e]}.bind(null,o));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},"0751":function(t,e,a){"use strict";var o=a("48f3"),n=a.n(o);n.a},"198a":function(t,e,a){"use strict";var o=a("f683"),n=a.n(o);n.a},"1e93":function(t,e,a){},"2aca":function(t,e,a){},"312b":function(t,e,a){"use strict";var o=a("1e93"),n=a.n(o);n.a},"31aa":function(t,e,a){},3385:function(t,e,a){},"3a40":function(t,e,a){"use strict";var o=a("7fe3"),n=a.n(o);n.a},"3a8e":function(t,e,a){"use strict";var o=a("5756"),n=a.n(o);n.a},"48f0":function(t,e,a){},"48f3":function(t,e,a){},"49a2":function(t,e,a){"use strict";var o=a("503d"),n=a.n(o);n.a},"4d25":function(t,e,a){},"503d":function(t,e,a){},5756:function(t,e,a){},5960:function(t,e,a){},"5c0b":function(t,e,a){"use strict";var o=a("9c0c"),n=a.n(o);n.a},"6bd7":function(t,e,a){"use strict";var o=a("ac00"),n=a.n(o);n.a},"7fe3":function(t,e,a){},8271:function(t,e,a){},9769:function(t,e,a){"use strict";var o=a("48f0"),n=a.n(o);n.a},"9c0c":function(t,e,a){},a3a1:function(t,e,a){"use strict";var o=a("3385"),n=a.n(o);n.a},a470:function(t,e,a){"use strict";var o=a("5960"),n=a.n(o);n.a},ac00:function(t,e,a){},aee9:function(t,e,a){},c96d:function(t,e,a){"use strict";var o=a("4d25"),n=a.n(o);n.a},ccd1:function(t,e,a){"use strict";var o=a("2aca"),n=a.n(o);n.a},cd49:function(t,e,a){"use strict";a.r(e);var o,n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("app-navbar",{attrs:{hide:t.appState.factoryFormOpen||t.appState.selectFactoryMode,fixed:!0},on:{menu:t.modalActions.toggleSidebar}},[t._v("農地違章工廠舉報")]),a("app-sidebar",{attrs:{clickActions:t.sidebarActions},model:{value:t.modalState.sidebarOpen,callback:function(e){t.$set(t.modalState,"sidebarOpen",e)},expression:"modalState.sidebarOpen"}}),a("filter-modal",{attrs:{open:t.appState.filterModalOpen,dismiss:t.closeFilterModal}}),a("create-factory-success-modal",{attrs:{open:t.modalState.createFactorySuccessModal,dismiss:t.modalActions.closeCreateFactorySuccessModal}}),a("update-factory-success-modal",{attrs:{open:t.modalState.updateFactorySuccessModal,dismiss:t.modalActions.closeUpdateFactorySuccessModal}}),a("about-modal",{attrs:{open:t.modalState.aboutModalOpen,dismiss:t.modalActions.closeAboutModal}}),a("contact-modal",{attrs:{open:t.modalState.contactModalOpen,dismiss:t.modalActions.closeContactModal}}),a("getting-started-modal",{attrs:{open:t.modalState.gettingStartedModalOpen,dismiss:t.modalActions.closeGettingStartedModal}}),a("safety-modal",{attrs:{open:t.modalState.safetyModalOpen,dismiss:t.modalActions.closeSafetyModal}}),a("Map",{attrs:{openCreateFactoryForm:t.openCreateFactoryForm,openEditFactoryForm:t.openEditFactoryForm,selectFactoryMode:t.appState.selectFactoryMode,enterSelectFactoryMode:t.enterSelectFactoryMode,exitSelectFactoryMode:t.exitSelectFactoryMode,setFactoryLocation:t.setFactoryLocation,openFilterModal:t.openFilterModal}}),t.appState.factoryFormOpen?a("form-page",{attrs:{mode:t.appState.formMode,factoryData:t.appState.factoryData,close:t.closeFactoryPage,selectFactoryMode:t.appState.selectFactoryMode,enterSelectFactoryMode:t.enterSelectFactoryMode,exitSelectFactoryMode:t.exitSelectFactoryMode,factoryLocation:t.appState.factoryLocation,setCreateFactorySuccessModal:t.setCreateFactorySuccessModal}}):t._e()],1)},i=[],s=(a("e260"),a("ddb0"),a("750b")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.selectFactoryMode?a("div",{staticClass:"navbar-container"},[a("app-navbar",{attrs:{dark:!1,fixed:!0},on:{back:t.onNavBack,menu:t.modalActions.toggleSidebar}},[t._v(" 新增資訊 ")])],1):t._e(),a("div",{staticClass:"map-container"},[a("div",{ref:"root",staticClass:"map"}),a("div",{ref:"popup",class:["popup",{show:t.popupData.show}],style:{borderColor:t.popupData.color}},[a("div",{staticClass:"close",on:{click:function(e){t.popupData.show=!1}}}),a("small",{style:{color:t.popupData.color}},[t._v(t._s(t.popupData.status))]),a("h3",[t._v(t._s(t.popupData.name))]),a("p",{staticClass:"summary"},[t._v(t._s(t.popupData.summary))]),a("app-button",{attrs:{outline:"",color:t.getButtonColorFromStatus()},on:{click:t.onClickEditFactoryData}},[t._v(" 補充資料 ")])],1),a("div",{staticClass:"ol-map-search ol-unselectable ol-control",on:{click:t.openFilterModal}},[t._m(0)]),a("div",{staticClass:"ol-fit-location ol-unselectable ol-control",on:{click:t.zoomToGeolocation}},[t._m(1)]),t.selectFactoryMode?a("div",{staticClass:"center-point"}):t._e(),a("div",{staticClass:"factory-button-group"},[t.selectFactoryMode?t._e():a("div",{staticClass:"create-factory-button"},[a("app-button",{on:{click:t.onClickCreateFactoryButton}},[t._v("我要新增違建工廠")])],1),t.selectFactoryMode?a("div",{staticClass:"choose-location-button"},[a("app-button",{attrs:{disabled:!t.factoryValid},on:{click:t.onClickFinishSelectFactoryPositionButton}},[t._v(" 選擇此地點 ")]),a("span",[t._v("可舉報範圍：白色區域")])],1):t._e()])])])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",[a("img",{attrs:{src:"/images/search.svg",alt:"search"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",[a("img",{attrs:{src:"/images/locate.svg",alt:"locate"}})])}],u=(a("2532"),a("9ab4")),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{class:{outline:t.outline,disabled:t.disabled,rect:t.rect,blue:"blue"===t.color,red:"red"===t.color,gray:"gray"===t.color},on:{click:t.click}},[t._t("default")],2)},p=[],m=Object(s["b"])({name:"AppButton",props:{outline:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rect:{type:Boolean,default:!1},color:{type:String,default:"default"}},setup(t,e){var a=()=>{t.disabled||e.emit("click")};return{click:a}}}),f=m,v=(a("a3a1"),a("2877")),y=Object(v["a"])(f,d,p,!1,null,"3c93b5ae",null),g=y.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{class:{dark:t.dark,fixed:t.fixed,hide:t.hide}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.dark,expression:"!dark"}],staticClass:"back-button",on:{click:function(e){return t.onBackClick()}}},[a("span"),a("span"),a("span")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.dark,expression:"dark"}],staticClass:"back-placeholder"}),t._t("default"),a("div",{staticClass:"menu-button",on:{click:function(e){return t.onMenuClick()}}},[a("span"),a("span"),a("span")])],2)},b=[],S=Object(s["b"])({name:"AppNavbar",props:{dark:{type:Boolean,default:!0},fixed:{type:Boolean,default:!1},back:{type:Function},hide:{type:Boolean,default:!1}},setup(t,e){var{emit:a}=e;return{onBackClick(){a("back")},onMenuClick(){a("menu")}}}}),F=S,_=(a("d54a"),Object(v["a"])(F,h,b,!1,null,"1c931af2",null)),M=_.exports,O=(a("e6cf"),a("4cdf")),w=a("a2c7"),E=a("5eee"),C=a("6c77"),x=a("6cbf"),k=a("ce2c"),j=a("83a6"),I=a("8682"),A=a("82b0"),T=a("f403"),P=a("d510"),L=a("6ed8"),U=a("256f"),G=a("0af5"),N=a("3e6b"),B=a("480c"),D=a("5831"),V=a("d0e9"),R=a("e29f"),$=a("9d47"),q=a("a7f7"),z=a("f53f"),X=a("3a39"),W=a("508e"),H=[{value:"2-1",text:"金屬: 沖床、銑床、車床、鏜孔"},{value:"2-2",text:"金屬: 焊接、鑄造、熱處理"},{value:"2-3",text:"金屬: 金屬表面處理、噴漆"},{value:"3",text:"塑膠加工、射出"},{value:"4",text:"橡膠加工"},{value:"5",text:"非金屬礦物（石材）"},{value:"6",text:"食品"},{value:"7",text:"皮革"},{value:"8",text:"紡織"},{value:"9",text:"其他"}];(function(t){t["NEW"]="NEW",t["EXISTING_INCOMPLETE"]="EXISTING_INCOMPLETE",t["EXISTING_COMPLETE"]="EXISTING_COMPLETE",t["REPORTED"]="REPORTED"})(o||(o={}));var J,Y={[o.NEW]:["新建違章工廠"],[o.EXISTING_COMPLETE]:["既有違章工廠"],[o.EXISTING_INCOMPLETE]:["既有違章工廠","資料不齊"],[o.REPORTED]:["已舉報違章工廠"]},Z=[o.NEW,o.EXISTING_COMPLETE,o.EXISTING_INCOMPLETE,o.REPORTED],K=window.OffscreenCanvas?new OffscreenCanvas(500,500):document.createElement("canvas"),Q=K.getContext("2d"),tt=t=>e=>{return new Promise(a=>{var o=new Image;o.crossOrigin="",o.src=e,o.style.display="none",o.onload=()=>Object(u["a"])(void 0,void 0,void 0,(function*(){K.width=o.width,K.height=o.height,Q.clearRect(0,0,K.width,K.height),Q.drawImage(o,0,0);var e=Q.getImageData(0,0,o.width,o.height),{data:n}=e;yield Promise.resolve(t(n));var r=document.createElement("canvas"),i=r.getContext("2d");r.width=o.width,r.height=o.height,i.putImageData(e,0,0),a(r.toDataURL()),o.remove(),r.remove()}))})},et=(tt(t=>{for(var e=0;e<t.length;e+=4){var a=(t[e]+t[e+1]+t[e+2])/3;t[e]=a,t[e+1]=a,t[e+2]=a}}),[[255,241,0]]),at=(t,e)=>!t.some((t,a)=>e[a]!==t),ot=t=>et.some(e=>at(e,t)),nt=tt(t=>{for(var e=0;e<t.length;e+=4){var a=Array.from(t.slice(e,e+3));ot(a)?(t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=1):(t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=255)}}),rt=a("d202"),it=t=>"/images/marker-".concat(t,".svg"),st=t=>{return{[o.NEW]:"#447287",[o.EXISTING_COMPLETE]:"#58585B",[o.EXISTING_INCOMPLETE]:"#58585B",[o.REPORTED]:"#6D8538"}[t]};function ct(t){return"B"===t.cet_report_status?o.REPORTED:t.before_release?t.data_complete?o.EXISTING_COMPLETE:o.EXISTING_INCOMPLETE:o.NEW}(function(t){t[t["OSM"]=0]="OSM",t[t["TAIWAN"]=1]="TAIWAN",t[t["SATELITE"]=2]="SATELITE"})(J||(J={}));var lt=()=>{return Object.entries({zoomIn:"/images/zoom-in.svg",zoomOut:"/images/zoom-out.svg"}).reduce((t,e)=>{var[a,o]=e,n=document.createElement("img");return n.setAttribute("src",o),Object.assign(Object.assign({},t),{[a]:n})},{})},ut=Object.entries(o).reduce((t,e)=>{var[a,o]=e;return Object.assign(Object.assign({},t),{[a]:new C["b"]({image:new x["a"]({anchorYUnits:A["a"].PIXELS,anchorOrigin:rt["a"].BOTTOM_LEFT,src:it(o)})})})},{}),dt=new C["b"]({}),pt=new C["b"]({image:new k["a"]({fill:new j["a"]({color:"#A22929"}),radius:12,stroke:new I["a"]({color:"#FFFFFF",width:1})})});class mt{constructor(t){this.appliedFilters=[],this.factoryMap=new Map,this._map=t}get mapInstance(){return this._map}get factories(){return[...this.factoryMap.values()]}get factoriesLayerSource(){if(!this._factoriesLayerSource){this._factoriesLayerSource=new D["a"]({features:[]});var t=new N["a"]({source:this._factoriesLayerSource,zIndex:3});this.mapInstance.map.addLayer(t)}return this._factoriesLayerSource}getFactory(t){return this.factoryMap.get(t)}updateFactory(t,e){this.factoryMap.set(t,e)}addFactories(t){var e=this.createFactoryFeature.bind(this),a=t.filter(t=>!this.factoryMap.has(t.id)).map(e);this.factoriesLayerSource.addFeatures(a),t.forEach(t=>this.updateFactory(t.id,t))}hideFactories(t){t.forEach(t=>{var e=this.factoriesLayerSource.getFeatureById(t.id);e.setStyle(dt)})}setFactoryStatusFilter(t){if(this.appliedFilters=t,0===t.length)return this.displayAllFactory();this.updateFactoriesFeatureStyle()}isFactoryVisible(t){return 0===this.appliedFilters.length||this.appliedFilters.includes(ct(t))}getFactoryStyle(t){var e=this.isFactoryVisible(t);return e?ut[ct(t)]:dt}createFactoryFeature(t){var e=new O["a"]({geometry:new T["a"](Object(U["i"])([t.lng,t.lat],"EPSG:4326","EPSG:3857"))});return e.setId(t.id),e.setStyle(this.getFactoryStyle(t)),e}forEachFeatureFactory(t){this.factoriesLayerSource.getFeatures().forEach(e=>{var a=e.getId(),o=this.factoryMap.get(a);t(e,o)})}displayAllFactory(){this.forEachFeatureFactory((t,e)=>{t.setStyle(ut[ct(e)])})}updateFactoriesFeatureStyle(){this.forEachFeatureFactory((t,e)=>{t.setStyle(this.getFactoryStyle(e))})}}var ft=()=>{for(var t=Object(U["d"])("EPSG:3857"),e=t.getExtent(),a=new Array(21),o=Object(G["E"])(e)/256,n=new Array(21),r=0;r<21;++r)a[r]=o/Math.pow(2,r),n[r]=r;return new L["b"]({origin:Object(G["C"])(e),resolutions:a,matrixIds:n})},vt=(t,e)=>{var a=(()=>{switch(t){case J.OSM:return new V["a"]({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'});case J.TAIWAN:return new P["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts",layer:"EMAP",tileGrid:e,crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});case J.SATELITE:return new P["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/PHOTO_MIX/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"EMAP",tileGrid:e,requestEncoding:"REST",crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});default:return new V["a"]({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'})}})();return new B["a"]({source:a,opacity:.6,zIndex:1})},yt=t=>{return new B["a"]({source:new P["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/nURBAN2/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"LUIMAP",requestEncoding:"REST",tileGrid:t,tileLoadFunction:function(t,e){var a=t.getImage();nt(e).then(t=>{a.src=t})},crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'}),opacity:.5,zIndex:2})};class gt{constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.tileGrid=ft(),this.mapDom=t,this.baseLayer=vt(J.OSM,this.tileGrid),this._map=this.instantiateOLMap(this.mapDom,this.baseLayer,a),a.minimap||(this.geolocation=this.setupGeolocationTracking(this._map)),this.setupEventListeners(this._map,e)}get map(){return this._map}setupEventListeners(t,e){var a=()=>Object(u["a"])(this,void 0,void 0,(function*(){var a=t.getView(),o=a.getZoom(),n=a.getResolutionForZoom(o),r=Math.ceil(n/2),[i,s]=Object(U["i"])(a.getCenter(),"EPSG:3857","EPSG:4326");if(e.onMoved){var{width:c,height:l}=this.mapDom.getBoundingClientRect(),u=yield this.canPlaceFactory([c/2,l/2]);e.onMoved([i,s,r],u)}}));t.on("change:resolution",a),t.on("moveend",a),t.on("click",a=>Object(u["a"])(this,void 0,void 0,(function*(){if(e.onClicked){var[o,n]=Object(U["i"])(a.coordinate,"EPSG:3857","EPSG:4326"),r=t.forEachFeatureAtPixel(a.pixel,t=>t,{layerFilter:t=>{return 5!==t.getZIndex()}});e.onClicked([o,n],r)}})))}instantiateOLMap(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=ft(),n=new w["a"]({center:Object(U["i"])([120.1,23.234],"EPSG:4326","EPSG:3857"),zoom:16}),r=lt(),i={target:t,layers:[e,yt(o)],view:n,controls:[new R["a"]({zoomInLabel:r.zoomIn,zoomOutLabel:r.zoomOut}),new $["a"],new q["a"]],interactions:Object(X["a"])({pinchRotate:!1}).extend([new W["a"]({threshold:.4})])};return a.minimap&&(i.controls=[],i.interactions=[]),new E["a"](i)}setupGeolocationTracking(t){var e=t.getView(),a=new z["a"]({trackingOptions:{enableHighAccuracy:!0},projection:e.getProjection()});a.setTracking(!0);var o=this.setupGeolocationLayer(a);return t.addLayer(o),a}setupGeolocationLayer(t){var e=new O["a"],a=t=>Number.isNaN(t)?new C["b"]({image:new k["a"]({fill:new j["a"]({color:"#0099ff"}),stroke:new I["a"]({color:"#fff",width:3}),radius:15})}):new C["b"]({image:new x["a"]({anchor:[.5,.5],src:"/images/now.svg",rotation:t,rotateWithView:!0})});e.setStyle(a(NaN)),t.on("change:position",(function(){var a=t.getPosition();e.setGeometry(a?new T["a"](a):void 0)})),t.on("change:heading",(function(){var o;e.setStyle(a((o=t.getHeading(),null!==o&&void 0!==o?o:NaN)))}));var o=new O["a"];t.on("change:accuracyGeometry",(function(){o.setGeometry(t.getAccuracyGeometry())}));var n=!1;t.on("change",()=>{if(!n){var e=t.getPosition();e&&(this.zoomToGeolocation(),n=!0)}});var r=new N["a"]({source:new D["a"]({features:[e,o]}),zIndex:5});return r}zoomToGeolocation(){if(this.geolocation){var t=this.geolocation.getPosition();if(t){var e=this._map.getView();e.setCenter(t),e.setZoom(16)}}}changeBaseMap(t){this._map.removeLayer(this.baseLayer),this.baseLayer=vt(t,this.tileGrid),this._map.addLayer(this.baseLayer)}canPlaceFactory(t){return new Promise(e=>{this._map.forEachLayerAtPixel(t,(function(t,a){var[,,,o]=a;return e(1===o)}),{layerFilter:function(t){return"LUIMAP"===t.getProperties().source.layer_}}),e(!1)})}getLUIMAPLayer(){return new Promise((t,e)=>{var a;this._map.getLayers().forEach(e=>{"LUIMAP"===e.getProperties().source.layer_&&(a=e,t(e))}),a||e(new TypeError("LUIMAP Layer not found"))})}setLUILayerVisible(t){return Object(u["a"])(this,void 0,void 0,(function*(){var e=yield this.getLUIMAPLayer();e.setVisible(t)}))}setMinimapPin(t,e){var a=Object(U["i"])([t,e],"EPSG:4326","EPSG:3857");if(this.minimapPinFeature)this.minimapPinFeature.setGeometry(new T["a"](a));else{var o=new O["a"]({geometry:new T["a"](a)});o.setStyle(pt),this.minimapPinFeature=o;var n=new D["a"]({features:[o]}),r=new N["a"]({source:n,zIndex:4});this.map.addLayer(r)}this._map.getView().setCenter(a)}}function ht(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new gt(t,e);return window.changeBaseMap=a.changeBaseMap.bind(a),new mt(a)}function bt(t,e){var a=new gt(t,{},{minimap:!0});return a.map.getView().setCenter(e),new mt(a)}a("2b3d");var St=a("bc3a"),Ft=a.n(St),_t="https://staging.disfactory.tw/api",Mt=Ft.a.create({baseURL:_t,headers:{"Content-Type":"application/json"}});function Ot(t,e,a){return Object(u["a"])(this,void 0,void 0,(function*(){try{var{data:o}=yield Mt.get("/factories?range=".concat(t,"&lng=").concat(e,"&lat=").concat(a));return o}catch(n){throw console.error(n),new TypeError("Get factory failed")}}))}function wt(t){return Object(u["a"])(this,void 0,void 0,(function*(){var e=[];for(var a of t){var o=new FormData;o.append("image",a);var{data:n}=yield Mt.post("/images",o,{headers:{"Content-Type":"multipart/form-data"}});e.push({token:n.token,src:URL.createObjectURL(a)})}return e}))}function Et(t,e,a){var{nickname:o,contact:n}=a;return Object(u["a"])(this,void 0,void 0,(function*(){var a=[];for(var r of e){var i=new FormData;i.append("image",r),o&&i.append("nickname",o),n&&i.append("contact",n);var{data:s}=yield Mt.post("/factories/".concat(t,"/images"),i,{headers:{"Content-Type":"multipart/form-data"}});a.push(s)}return a}))}function Ct(t){return Object(u["a"])(this,void 0,void 0,(function*(){try{var{data:e}=yield Mt.post("/factories",JSON.stringify(t));return e}catch(a){throw console.error(a),new TypeError("Create factory failed")}}))}function xt(t,e){return Object(u["a"])(this,void 0,void 0,(function*(){try{var{data:a}=yield Mt.put("/factories/".concat(t),JSON.stringify(e));return a}catch(o){throw console.error(o),new TypeError("Update factory failed")}}))}a("e01a");var kt=Symbol("MAIN_MAP_CONTROLLER"),jt=a("0710"),It=a("698f");function At(t){var e=e=>{"backPressed"===e.state&&t()};window.history.pushState("backPressed","",null),window.history.pushState("dummy","",null),window.addEventListener("popstate",e,{once:!0}),Object(s["f"])(()=>{window.removeEventListener("popstate",e)})}var Tt=Symbol("GASymbol");function Pt(t){Object(s["g"])(Tt,t.root.$gtag)}function Lt(){var t=Object(s["d"])(Tt);if(!t)throw new Error("use provideGA before useGA");var e=e=>{t.pageview({page_path:e})},a=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.event(e,a)};return{pageview:e,event:a}}var Ut=Symbol("GASymbol"),Gt=()=>{var t=Object(s["h"])({updateFactorySuccessModal:!1,createFactorySuccessModal:!1,aboutModalOpen:!1,contactModalOpen:!1,safetyModalOpen:!1,gettingStartedModalOpen:"true"!==localStorage.getItem("use-app"),sidebarOpen:!1});return Object(s["g"])(Ut,t),t},Nt=()=>{var t=Object(s["d"])(Ut),{event:e}=Lt(),a=()=>{t.updateFactorySuccessModal=!0},o=()=>{t.updateFactorySuccessModal=!1},n=()=>{t.createFactorySuccessModal=!0},r=()=>{t.createFactorySuccessModal=!1},i=()=>{t.aboutModalOpen=!0},c=()=>{t.aboutModalOpen=!1},l=()=>{t.contactModalOpen=!0},u=()=>{t.contactModalOpen=!1},d=()=>{t.safetyModalOpen=!0},p=()=>{t.safetyModalOpen=!1},m=()=>{t.gettingStartedModalOpen=!0},f=()=>{t.gettingStartedModalOpen=!1},v=()=>{var a=!t.sidebarOpen;e("toggleSidebar",{target:a}),t.sidebarOpen=a},y={openUpdateFactorySuccessModal:a,closeUpdateFactorySuccessModal:o,openCreateFactorySuccessModal:n,closeCreateFactorySuccessModal:r,openAboutModal:i,closeAboutModal:c,openContactModal:l,closeContactModal:u,openSafetyModal:d,closeSafetyModal:p,openGettingStartedModal:m,closeGettingStartedModal:f,toggleSidebar:v};return[t,y]},Bt=Object(s["b"])({components:{AppButton:g,AppNavbar:M},props:{openCreateFactoryForm:{type:Function,required:!0},openEditFactoryForm:{type:Function,required:!0},selectFactoryMode:{type:Boolean,required:!0},enterSelectFactoryMode:{type:Function,required:!0},exitSelectFactoryMode:{type:Function,required:!0},setFactoryLocation:{type:Function,required:!0},openFilterModal:{type:Function,required:!0}},setup(t){var{event:e}=Lt(),a=Object(s["i"])(null),n=Object(s["i"])(null),r=Object(s["i"])(!1),i=Object(s["i"])([]),c=Object(s["d"])(kt,Object(s["i"])()),[,l]=Nt(),d=Object(s["i"])({show:!1,id:"",name:"",color:"",status:"",summary:""}),p=Object(s["i"])(null),m=t=>{var e=t.images.length>0?"已有照片":"缺照片",a=H.find(e=>e.value===t.type),o=a&&a.text||"其他";return o.includes("金屬")&&(o="金屬"),[e,o].filter(Boolean).join("\n")},f=t=>{if(c.value){var e=c.value.getFactory(t);if(e){d.value.id=e.id,d.value.name=e.name;var a=ct(e);d.value.color=st(a),d.value.status=Y[a][0],d.value.show=!0,d.value.summary=m(e),p.value=e}}},v=()=>{p.value&&t.openEditFactoryForm(p.value)};Object(s["e"])(()=>{var t=new jt["a"]({element:n.value,positioning:It["a"].BOTTOM_LEFT}),o=ht(a.value,{onMoved:function(t,a){var[n,s,c]=t;return Object(u["a"])(this,void 0,void 0,(function*(){r.value=a,i.value=[n,s],e("moveMap");try{var t=yield Ot(c,n,s);Array.isArray(t)&&o.addFactories(t)}catch(l){}}))},onClicked:function(a,o){return Object(u["a"])(this,void 0,void 0,(function*(){o?(e("clickPopup"),t.setPosition(o.getGeometry().getCoordinates()),f(o.getId())):d.value.show=!1}))}});o.mapInstance.map.addOverlay(t),c.value=o,o.mapInstance.setLUILayerVisible(!1)});var y=()=>{c.value&&c.value.mapInstance.setLUILayerVisible(!1),t.exitSelectFactoryMode()};function g(){c.value&&(c.value.mapInstance.setLUILayerVisible(!0),t.enterSelectFactoryMode(),d.value.show=!1,At(y))}function h(){c.value&&(c.value.mapInstance.setLUILayerVisible(!1),t.setFactoryLocation(i.value),t.exitSelectFactoryMode(),t.openCreateFactoryForm())}return{root:a,modalActions:l,popup:n,factoryValid:r,zoomToGeolocation:function(){c.value&&(e("zoomToGeolocation"),c.value.mapInstance.zoomToGeolocation())},onNavBack(){y()},popupData:d,onClickEditFactoryData:v,onClickCreateFactoryButton:g,onClickFinishSelectFactoryPositionButton:h,getButtonColorFromStatus:function(){if(!p.value)return"default";var t=ct(p.value);return{[o.NEW]:"blue",[o.EXISTING_INCOMPLETE]:"gray",[o.EXISTING_COMPLETE]:"gray",[o.REPORTED]:"default"}[t]}}}}),Dt=Bt,Vt=(a("3a8e"),Object(v["a"])(Dt,c,l,!1,null,"6d6ee544",null)),Rt=Vt.exports,$t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{base:!0,open:t.value},on:{click:t.close}},[a("div",{class:{sidebar:!0,open:t.value}},[a("div",{staticClass:"close",on:{click:t.close}}),a("h1",[t._v("主選單")]),a("hr"),a("ul",t._l(t.links,(function(e,o){return a("li",{key:o},[a("a",{on:{click:function(e){return e.stopPropagation(),t.clickActions[o](e)}}},[t._v(t._s(e.text))])])})),0)])])},qt=[],zt=Object(s["b"])({name:"AppSidebar",props:{value:{type:Boolean,required:!0},clickActions:{type:Array,required:!0,default:[]}},setup(t,e){var a=Object(s["i"])([{text:"使用教學"},{text:"安全須知"},{text:"聯絡我們"},{text:"關於舉報系統"}]),o=()=>{e.emit("input",!1)};return{links:a,close:o}}}),Xt=zt,Wt=(a("49a2"),Object(v["a"])(Xt,$t,qt,!1,null,"5af25fd2",null)),Ht=Wt.exports,Jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"navbar-container"},[a("app-navbar",{attrs:{dark:!1,fixed:!0},on:{back:t.onNavBack,menu:t.modalActions.toggleSidebar}},[t._v(" "+t._s(t.isCreateMode?"新增資訊":"補充資訊")+" ")])],1),a("div",{staticClass:"page-container",class:{hide:t.selectFactoryMode}},[a("image-upload-modal",{attrs:{open:t.formPageState.imageUploadModalOpen,dismiss:t.closeImageUploadModal,images:t.imagesToUpload,finishImagesUpload:t.finishImagesUpload,finishUploaderForm:t.finishUploaderForm,mode:t.mode,factoryData:t.factoryData}}),a("div",{staticClass:"page",staticStyle:{padding:"29px 35px"}},[t.isCreateMode?a("h1",[t._v(" 輸入資訊 ")]):t._e(),t.isCreateMode?t._e():a("div",{staticClass:"status-banner flex",style:{backgroundColor:t.getStatusBorderColor(t.factoryFormState.status)}},[a("img",{staticStyle:{"margin-right":"7px"},attrs:{src:"/images/marker-white.svg"}}),t._v(" "+t._s(t.FactoryStatusText[t.factoryFormState.status][0])+" ")]),a("h3",[t._v("工廠地點")]),a("div",{ref:"minimap",staticClass:"minimap",on:{click:function(e){return t.onClickMinimap()}}}),a("div",{staticClass:"flex justify-between",staticStyle:{"margin-top":"40px","margin-bottom":"20px"}},[t._m(0),a("div",[a("label",[a("input",{ref:"image",staticStyle:{visibility:"hidden",position:"absolute","pointer-events":"none",left:"-1000px"},attrs:{multiple:"",type:"file",accept:"image/*"},on:{change:t.handleImagesUpload}}),t.isiOS||t.isSafari?a("app-button",[t._v("新增")]):a("app-button",{on:{click:t.onClickImageUpload}},[t._v("新增")])],1)])]),a("div",{staticClass:"images-grid"},t._l(t.factoryFormState.imageUrls,(function(t){return a("div",{key:t,staticClass:"image-card"},[a("img",{attrs:{src:t}})])})),0),a("h3",[t._v("工廠名稱")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-text-field",{attrs:{placeholder:"請輸入工廠名稱"},model:{value:t.factoryFormState.name,callback:function(e){t.$set(t.factoryFormState,"name",e)},expression:"factoryFormState.name"}})],1),t.isEditMode?a("div",{staticStyle:{width:"100px",height:"47px","margin-left":"-3px"}},[a("app-button",{attrs:{rect:"",disabled:t.fieldSubmittingState.name_submitting},on:{click:function(e){return t.updateFactoryFieldsFor("name",t.factoryFormState.name)}}},[t._v(" "+t._s(t.fieldSubmittingState.name_submitting?"更新中":"更新")+" ")])],1):t._e()]),a("h3",[t._v("工廠類型")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-select",{attrs:{items:t.factoryTypeItems},model:{value:t.factoryFormState.type,callback:function(e){t.$set(t.factoryFormState,"type",e)},expression:"factoryFormState.type"}})],1),t.isEditMode?a("div",{staticStyle:{width:"100px",height:"47px","margin-left":"-3px"}},[a("app-button",{attrs:{rect:"",disabled:t.fieldSubmittingState.factory_type_submitting},on:{click:function(e){return t.updateFactoryFieldsFor("factory_type",t.factoryFormState.type)}}},[t._v(" "+t._s(t.fieldSubmittingState.factory_type_submitting?"更新中":"更新")+" ")])],1):t._e()]),a("h3",[t._v("新增其它資訊")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-text-field",{attrs:{placeholder:"請填入其他資訊，如聲音、氣味等等。"},model:{value:t.factoryFormState.others,callback:function(e){t.$set(t.factoryFormState,"others",e)},expression:"factoryFormState.others"}})],1),t.isEditMode?a("div",{staticStyle:{width:"100px",height:"47px","margin-left":"-3px"}},[a("app-button",{attrs:{rect:"",disabled:t.fieldSubmittingState.others_submitting},on:{click:function(e){return t.updateFactoryFieldsFor("others",t.factoryFormState.others)}}},[t._v(" "+t._s(t.fieldSubmittingState.others_submitting?"更新中":"更新")+" ")])],1):t._e()]),t.isCreateMode?a("div",{staticClass:"text-center width-auto",staticStyle:{"margin-top":"60px"}},[a("app-button",{attrs:{disabled:!t.formPageState.valid||t.formPageState.submitting},on:{click:function(e){return t.submitFactory()}}},[t._v(" "+t._s(t.formPageState.submitting?"上傳資料中":"送出")+" ")])],1):t._e()])],1)])},Yt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex flex-column flex-auto"},[a("h3",{staticStyle:{"margin-top":"0"}},[t._v("工廠照片*")]),a("label",[a("small",[t._v("請上傳至少一張照片")])])])}],Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return"checkbox"===t.type?a("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.inputValue)?t._i(t.inputValue,null)>-1:t.inputValue},on:{change:function(e){var a=t.inputValue,o=e.target,n=!!o.checked;if(Array.isArray(a)){var r=null,i=t._i(a,r);o.checked?i<0&&(t.inputValue=a.concat([r])):i>-1&&(t.inputValue=a.slice(0,i).concat(a.slice(i+1)))}else t.inputValue=n}}},"input",t.$attrs,!1)):"radio"===t.type?a("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],attrs:{type:"radio"},domProps:{checked:t._q(t.inputValue,null)},on:{change:function(e){t.inputValue=null}}},"input",t.$attrs,!1)):a("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],attrs:{type:t.type},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}},"input",t.$attrs,!1))},Kt=[],Qt=Object(s["b"])({name:"AppTextField",props:{type:{type:String,default:"text"},value:{type:String,required:!0}},setup(t,e){var a=Object(s["a"])({get:()=>t.value,set:t=>e.emit("input",t)});return{inputValue:a}}}),te=Qt,ee=(a("6bd7"),Object(v["a"])(te,Zt,Kt,!1,null,"1dc8b942",null)),ae=ee.exports,oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"select"},[a("select",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.inputValue=e.target.multiple?a:a[0]}}},"select",t.$attrs,!1),t._l(t.items,(function(e){return a("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0)])},ne=[],re=Object(s["b"])({name:"AppSelect",props:{value:{type:null,required:!0},items:{type:Array,required:!0}},setup(t,e){var a=Object(s["a"])({get:()=>t.value,set:t=>e.emit("input",t)});return{inputValue:a}}}),ie=re,se=(a("312b"),Object(v["a"])(ie,oe,ne,!1,null,"4f226c2f",null)),ce=se.exports,le=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-modal",{staticClass:"page",attrs:{open:t.open,dismiss:t.closeModal}},[a("h2",[t._v("工廠照片")]),a("div",{staticClass:"images-grid"},t._l(t.imageUrls,(function(t){return a("div",{key:t,staticClass:"image-card"},[a("img",{attrs:{src:t}})])})),0),a("h2",[t._v(" 聯絡資訊（非必填）"),a("br"),a("small",{staticStyle:{"font-size":"14px"}},[t._v("如果對於照片有疑問，我們會透過您提供的資訊聯絡你。")])]),a("h3",[t._v("稱呼")]),a("app-text-field",{attrs:{placeholder:"例：林先生"},model:{value:t.formState.nickname,callback:function(e){t.$set(t.formState,"nickname",e)},expression:"formState.nickname"}}),a("h3",[t._v("聯絡資料")]),a("app-text-field",{attrs:{placeholder:"例：0912345678"},model:{value:t.formState.contact,callback:function(e){t.$set(t.formState,"contact",e)},expression:"formState.contact"}}),a("div",{staticStyle:{"margin-top":"35px"}},[a("app-button",{attrs:{disabled:t.formState.uploading},on:{click:function(e){return t.handleImagesUpload()}}},[t._v(" "+t._s(t.formState.uploading?"上傳中":"上傳照片")+" ")])],1)],1)},ue=[],de=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-modal-component",class:{open:t.open}},[a("div",{staticClass:"app-modal-backdrop",on:{click:t.dismiss}}),a("div",{staticClass:"app-modal"},[t.showCloseButon?a("div",{staticClass:"close",on:{click:t.dismiss}}):t._e(),t._t("default")],2)])},pe=[],me=Object(s["b"])({name:"AppModal",props:{open:{type:Boolean,default:!1},dismiss:{type:Function},showCloseButon:{type:Boolean,default:!0}}}),fe=me,ve=(a("198a"),Object(v["a"])(fe,de,pe,!1,null,"0999ded1",null)),ye=ve.exports,ge=Object(s["b"])({name:"FilterModal",components:{AppModal:ye,AppButton:g,AppTextField:ae},props:{open:{type:Boolean,default:!1},dismiss:{type:Function,required:!0},images:{type:FileList},finishImagesUpload:{type:Function,required:!0},finishUploaderForm:{type:Function,required:!0},mode:{type:String,required:!0,defaultValue:"create"},factoryData:{type:Object,required:!0}},setup(t){var{event:e}=Lt(),a=Object(s["h"])({nickname:"",contact:"",uploading:!1}),o=Object(s["a"])(()=>{for(var e=[],a=0;a<t.images.length;a++)e.push(URL.createObjectURL(t.images[a]));return e});return{formState:a,imageUrls:o,handleImagesUpload(){return Object(u["a"])(this,void 0,void 0,(function*(){if(a.uploading=!0,"create"===t.mode)try{e("uploadImages");var n=yield wt(t.images);t.finishUploaderForm(a.nickname,a.contact),yield t.finishImagesUpload(n,o),a.uploading=!1,t.dismiss()}catch(i){a.uploading=!1,console.error(i)}else{e("updateFactoryImages");var r=yield Et(t.factoryData.id,t.images,{nickname:a.nickname,contact:a.contact});t.finishUploaderForm(a.nickname,a.contact),yield t.finishImagesUpload(r,[]),a.uploading=!1,t.dismiss()}}))},closeModal(){a.uploading||(t.finishImagesUpload([]),t.finishUploaderForm("",""),t.dismiss())}}}}),he=ge,be=(a("f8c3"),Object(v["a"])(he,le,ue,!1,null,"219bceb2",null)),Se=be.exports,Fe=(a("25f0"),a("466d"),!(!navigator.userAgent.match(/(iPod|iPhone|iPad)/)||!navigator.userAgent.match(/AppleWebKit/))),_e=/constructor/i.test(window.HTMLElement)||function(t){return"[object SafariRemoteNotification]"===t.toString()}(!window.safari||"undefined"!==typeof window.safari&&window.safari.pushNotification),Me=Object(s["b"])({name:"FormPage",components:{AppButton:g,AppTextField:ae,AppSelect:ce,AppNavbar:M,ImageUploadModal:Se},props:{close:{type:Function,required:!0},selectFactoryMode:{type:Boolean,required:!0},enterSelectFactoryMode:{type:Function,required:!0},exitSelectFactoryMode:{type:Function,required:!0},factoryLocation:{type:Array,required:!0},setCreateFactorySuccessModal:{type:Function,required:!0},mode:{type:String,required:!0,defaultValue:"create"},factoryData:{type:Object,required:!0}},setup(t){var e,{event:a}=Lt(),o=Object(s["d"])(kt,Object(s["i"])()),[,n]=Nt(),r=()=>{o.value&&(o.value.mapInstance.setLUILayerVisible(!1),t.close(),t.exitSelectFactoryMode())};At(r);var i="edit"===t.mode,c="create"===t.mode,l=[{text:"請選擇工廠類型",value:"0"},...H],d={name:"",others:"",type:"0",lng:0,lat:0,images:[],imageUrls:[],nickname:"",contact:"",status:""};if(i){var{factoryData:p}=t;d.name=p.name,d.type=p.factory_type,d.others=p.others,d.imageUrls=p.images.map(t=>t.image_path),d.lng=p.lng,d.lat=p.lat,d.status=ct(p)}var m=Object(s["h"])(d),f=Object(s["h"])({imageUploadModalOpen:!1,valid:!1,submitting:!1}),v=Object(s["h"])({name_submitting:!1,factory_type_submitting:!1,others_submitting:!1});Object(s["j"])(()=>{var{images:t}=m,e=t.length>0;f.valid=e});var y=()=>{f.imageUploadModalOpen=!1,a("closeImageUploadModal")},g=()=>{f.imageUploadModalOpen=!0,a("openImageUploadModal")},h=Object(s["i"])([]),b=Object(s["i"])(null),S=(t,e)=>{m.nickname=t,m.contact=e},F=(e,r)=>Object(u["a"])(this,void 0,void 0,(function*(){var{factoryData:s}=t;if(i&&s){var c="".concat(e,"_submitting");try{v[c]=!0,a("updateFactory",{field:e});var l=yield xt(s.id,{[e]:r});v[c]=!1,o.value&&o.value.updateFactory(s.id,l),n.openUpdateFactorySuccessModal()}catch(u){console.error(u)}}})),_=Object(s["i"])(null);return Object(s["e"])(()=>{if(o.value){var a=o.value,n=a.mapInstance.map.getView().getCenter();if(e=bt(_.value,n),e.addFactories(a.factories),i){var{factoryData:r}=t;e.mapInstance.setMinimapPin(r.lng,r.lat)}else if(c){var[s,l]=t.factoryLocation;e.mapInstance.setMinimapPin(s,l)}}}),Object(s["j"])(()=>t.factoryLocation,()=>{if(c&&e){var[a,o]=t.factoryLocation;e.mapInstance.setMinimapPin(a,o)}}),{minimap:_,onClickMinimap:()=>{c&&o.value&&(o.value.mapInstance.setLUILayerVisible(!0),t.enterSelectFactoryMode())},factoryFormState:m,formPageState:f,fieldSubmittingState:v,factoryTypeItems:l,containerStyle:{width:"100%"},openImageUploadModal:g,closeImageUploadModal:y,imagesToUpload:h,image:b,isiOS:Fe,isSafari:_e,onClickImageUpload(){b.value.click()},handleImagesUpload(t){h.value=t.target.files,g()},finishImagesUpload(e,a){return Object(u["a"])(this,void 0,void 0,(function*(){if(c)m.imageUrls=a,m.images=e.map(t=>t.token);else if(i)try{var r=Object.assign({},t.factoryData);m.imageUrls=m.imageUrls.concat(e.map(t=>t.image_path)),r.images=r.images.concat(e),o.value&&o.value.updateFactory(t.factoryData.id,r),n.openUpdateFactorySuccessModal()}catch(s){console.error(s)}}))},onNavBack(){o.value&&r()},submitFactory(){return Object(u["a"])(this,void 0,void 0,(function*(){f.submitting=!0;try{var[e,n]=t.factoryLocation,r={name:m.name,others:m.others,type:m.type,lng:e,lat:n,images:m.images,nickname:m.nickname,contact:m.contact};a("createFactory",{lng:e,lat:n});var i=yield Ct(r);o.value&&o.value.addFactories([i])}catch(s){}finally{f.submitting=!1}t.close(),t.exitSelectFactoryMode(),t.setCreateFactorySuccessModal(!0)}))},finishUploaderForm:S,isEditMode:i,isCreateMode:c,updateFactoryFieldsFor:F,getStatusBorderColor:st,FactoryStatusText:Y,getFactoryStatus:ct,modalActions:n}}}),Oe=Me,we=(a("a470"),Object(v["a"])(Oe,Jt,Yt,!1,null,"45ad3b82",null)),Ee=we.exports,Ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"filter-modal-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("div",{staticClass:"page-inner"},[a("h2",{staticStyle:{"margin-right":"30px"}},[t._v("篩選")]),t._l(t.FACTORY_STATUS_ITEMS,(function(e){return a("label",{key:e,staticClass:"checkbox-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.filters[e],expression:"filters[status]"}],attrs:{type:"checkbox",name:e},domProps:{checked:Array.isArray(t.filters[e])?t._i(t.filters[e],null)>-1:t.filters[e]},on:{change:function(a){var o=t.filters[e],n=a.target,r=!!n.checked;if(Array.isArray(o)){var i=null,s=t._i(o,i);n.checked?s<0&&t.$set(t.filters,e,o.concat([i])):s>-1&&t.$set(t.filters,e,o.slice(0,s).concat(o.slice(s+1)))}else t.$set(t.filters,e,r)}}}),a("span",{staticClass:"checkbox"}),a("span",{staticClass:"data-type",class:{"has-description":t.FactoryStatusText[e][1]}},[t._v(" "+t._s(t.FactoryStatusText[e][0])+" "),t.FactoryStatusText[e][1]?a("small",[t._v(t._s(t.FactoryStatusText[e][1]))]):t._e()]),a("span",{staticClass:"space"}),a("img",{attrs:{src:"/images/marker-"+e+".svg"}})])}))],2),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("app-button",{on:{click:function(e){return t.onClick()}}},[t._v("確認")])],1)])])],1)},xe=[],ke=Object(s["b"])({name:"FilterModal",components:{AppModal:ye,AppButton:g},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup(t){var e=Object(s["h"])({[o.NEW]:!1,[o.EXISTING_INCOMPLETE]:!1,[o.EXISTING_COMPLETE]:!1,[o.REPORTED]:!1}),a=Object(s["d"])(kt,Object(s["i"])());return{filters:e,onClick(){if(a.value){var o=Object.entries(e).map(t=>{var[e,a]=t;return!!a&&e}).filter(Boolean);a.value.setFactoryStatusFilter(o),"function"===typeof t.dismiss&&t.dismiss()}},FACTORY_STATUS_ITEMS:Z,FactoryStatus:o,FactoryStatusText:Y}}}),je=ke,Ie=(a("3a40"),Object(v["a"])(je,Ce,xe,!1,null,null,null)),Ae=Ie.exports,Te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"about-dialog-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("h3",[t._v("關於舉報系統")]),a("p",[t._v(" 農地違章工廠舉報系統為協助民眾回報揭露農地違章工廠資訊，並非實際完成舉報。 ")]),a("p",[t._v(" 地球公民基金會將整理資料進行部分案件追蹤，完成舉報者可於「已舉報」案件查見。 ")]),a("p",[t._v(" 105.05.20 前的違章工廠我們將持續收集資訊，但本系統優先針對新增建與中高污染違章工廠進行舉報。 ")]),a("p",[t._v(" 本系統感謝 g0v.tw 社群朋友共同開發。 ")]),a("p",[t._v(" 既有疑似違章工廠資料來源為 2019 年 7 月 30 日取自內政部國土測繪圖資雲"),a("a",{attrs:{href:"https://maps.nlsc.gov.tw/"}},[t._v("網站")]),t._v("。 ")]),a("p",[t._v(" 全站使用者貢獻資料以 "),a("a",{attrs:{href:"https://creativecommons.org/licenses/by/3.0/tw/"}},[t._v("CC BY 姓名標示 3.0")]),t._v(" 釋出，標註「© 農地違章工廠舉報小幫手貢獻者」，原始碼以 MIT 開放授權公開在 "),a("a",{attrs:{href:"https://github.com/Disfactory/Disfactory"}},[t._v("GitHub")]),t._v(" 上 ")])])])],1)},Pe=[],Le=Object(s["b"])({name:"AboutModal",components:{AppModal:ye},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Ue=Le,Ge=(a("9769"),Object(v["a"])(Ue,Te,Pe,!1,null,null,null)),Ne=Ge.exports,Be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contact-modal-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("img",{attrs:{width:"137",src:"/images/cet-logo.png",alt:"Citizen of the Earth Taiwan"}}),a("h3",[t._v(" 有任何舉報相關問題"),a("br"),t._v(" 歡迎聯絡 ")]),a("p",[t._v(" 地球公民基金會"),a("br"),t._v(" TEL: 07-2156809"),a("br"),t._v(" Email: "),a("a",{attrs:{href:"mailto:cet@cet-taiwan.org"}},[t._v("cet@cet-taiwan.org")]),a("br")])])])],1)},De=[],Ve=Object(s["b"])({name:"ContactModal",components:{AppModal:ye},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Re=Ve,$e=(a("f3e5"),Object(v["a"])(Re,Be,De,!1,null,null,null)),qe=$e.exports,ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"getting-started-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("pre",[t._v("        嗨，歡迎來到農地違章工廠舉報小幫手！\n        你回報的新增建違章工廠\n        既有中高污染工廠\n        會由地球公民基金會\n        做案件追蹤\n        向政府進行舉報\n\n        使用教學在右上角"),a("img",{attrs:{width:"30",src:"/images/menu-pic.png"}}),t._v("喔！\n\n        本網站由地球公民基金會與 g0v 社群共同開發\n      ")])])])],1)},Xe=[],We=Object(s["b"])({name:"GettingStartedModal",components:{AppModal:ye},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),He=We,Je=(a("d1c5"),Object(v["a"])(He,ze,Xe,!1,null,null,null)),Ye=Je.exports,Ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"safety-modal-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("carousel",{attrs:{"per-page":1,paginationActiveColor:"#6E8501",paginationColor:"#e3e3e3",paginationPadding:5}},[a("slide",[a("h1",[t._v("安全須知")]),a("p",[t._v(" 請參考以下建議，前往違章工廠拍照蒐證 ")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/1.png",alt:""}}),a("h2",[t._v(" 場勘 ")]),a("p",[t._v(" 假裝路過，檢查有無監視器；尋找適合拍照的隱蔽處 ")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/2.png",alt:""}}),a("h2",[t._v("藏身")]),a("p",[t._v(" 盡量避開監視器、他人視線；盡量在隱蔽處拍照（例如：車上、民宅內、樹叢間、遠方） ")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/3.png",alt:""}}),a("h2",[t._v("避嫌")]),a("p",[t._v("假如地點不夠隱密，請用手機拍照，降低他人戒心")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/4.png",alt:""}}),a("h2",[t._v("速離")]),a("p",[t._v("拍到1張清晰照片即可離去")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/5.png",alt:""}}),a("h2",[t._v("應變")]),a("p",[t._v("假如有人上前問話，請表現得「充滿好奇心」，試著跟對方聊天（例如：好奇水電師傅的施工技術），再伺機離開。")])])],1)],1)])],1)},Ke=[],Qe=a("0a63"),ta=Object(s["b"])({name:"SafetyModal",components:{AppModal:ye,Carousel:Qe["Carousel"],Slide:Qe["Slide"]},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),ea=ta,aa=(a("0751"),Object(v["a"])(ea,Ze,Ke,!1,null,null,null)),oa=aa.exports,na=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss,showCloseButon:!1}},[a("h3",[t._v("感謝您新增資訊！")]),a("app-button",{on:{click:t.dismiss}},[t._v("確認")])],1)},ra=[],ia=Object(s["b"])({name:"CreateFactorySuccessModal",components:{AppModal:ye,AppButton:g},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),sa=ia,ca=(a("ccd1"),Object(v["a"])(sa,na,ra,!1,null,"3436fde9",null)),la=ca.exports,ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss,showCloseButon:!1}},[a("h3",[t._v("感謝您補充資訊！")]),a("app-button",{on:{click:t.dismiss}},[t._v("確認")])],1)},da=[],pa=Object(s["b"])({name:"UpdateFactorySuccessModal",components:{AppModal:ye,AppButton:g},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),ma=pa,fa=(a("c96d"),Object(v["a"])(ma,ua,da,!1,null,"18cc98a4",null)),va=fa.exports,ya=Object(s["b"])({name:"App",components:{Map:Rt,AppButton:g,AppNavbar:M,AppSidebar:Ht,FilterModal:Ae,AboutModal:Ne,ContactModal:qe,GettingStartedModal:Ye,SafetyModal:oa,CreateFactorySuccessModal:la,UpdateFactorySuccessModal:va,FormPage:Ee},setup(t,e){Pt(e),Gt(),localStorage.setItem("use-app","true");var[a,o]=Nt(),{pageview:n,event:r}=Lt(),i=Object(s["h"])({filterModalOpen:!1,formMode:"create",factoryFormOpen:!1,factoryData:null,factoryLocation:[],selectFactoryMode:!1});function c(){r("closeFilterModal"),i.filterModalOpen=!1}function l(){r("openFilterModal"),i.filterModalOpen=!0}var u=()=>{i.factoryData=null,i.formMode="create",i.factoryFormOpen=!0,n("/create")},d=t=>{i.factoryData=t,i.formMode="edit",i.factoryFormOpen=!0,n("/edit")};function p(){i.factoryFormOpen=!1,r("closeFactoryPage")}var m=t=>{i.factoryLocation=t,r("setFactoryLocation")};function f(){i.selectFactoryMode=!0,r("enterSelectFactoryMode")}function v(){i.selectFactoryMode=!1,r("exitSelectFactoryMode")}return Object(s["g"])(kt,Object(s["i"])(null)),{appState:i,sidebarActions:[()=>{},o.openSafetyModal,o.openContactModal,o.openAboutModal],openFilterModal:l,closeFilterModal:c,openCreateFactoryForm:u,openEditFactoryForm:d,closeFactoryPage:p,enterSelectFactoryMode:f,exitSelectFactoryMode:v,setFactoryLocation:m,modalState:a,modalActions:o}}}),ga=ya,ha=(a("5c0b"),Object(v["a"])(ga,r,i,!1,null,null,null)),ba=ha.exports,Sa=a("2bdd"),Fa=a.n(Sa);n["a"].config.productionTip=!1,n["a"].use(s["c"]),n["a"].use(Fa.a,{config:{id:"UA-154739393-1"},enabled:!0}),new n["a"]({render:t=>t(ba)}).$mount("#app")},d1c5:function(t,e,a){"use strict";var o=a("8271"),n=a.n(o);n.a},d54a:function(t,e,a){"use strict";var o=a("aee9"),n=a.n(o);n.a},f3e5:function(t,e,a){"use strict";var o=a("31aa"),n=a.n(o);n.a},f683:function(t,e,a){},f8c3:function(t,e,a){"use strict";var o=a("fae5"),n=a.n(o);n.a},fae5:function(t,e,a){}});
//# sourceMappingURL=app.f66f2c0e.js.map