(function(t){function e(e){for(var n,i,c=e[0],s=e[1],l=e[2],p=0,d=[];p<c.length;p++)i=c[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,c=1;c<a.length;c++){var s=a[c];0!==o[s]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},o={app:0},r=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=s;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},"0751":function(t,e,a){"use strict";var n=a("48f3"),o=a.n(n);o.a},"07be":function(t,e,a){"use strict";var n=a("bfd3"),o=a.n(n);o.a},"1bed":function(t,e,a){"use strict";var n=a("2575"),o=a.n(n);o.a},"1e93":function(t,e,a){},2575:function(t,e,a){},"27f0":function(t,e,a){"use strict";var n=a("6058"),o=a.n(n);o.a},"2ff0":function(t,e,a){},"312b":function(t,e,a){"use strict";var n=a("1e93"),o=a.n(n);o.a},"31aa":function(t,e,a){},"36eb":function(t,e,a){"use strict";var n=a("2ff0"),o=a.n(n);o.a},"3a40":function(t,e,a){"use strict";var n=a("7fe3"),o=a.n(n);o.a},"48f0":function(t,e,a){},"48f3":function(t,e,a){},"4f2d":function(t,e,a){"use strict";var n=a("c4ff"),o=a.n(n);o.a},"5c0b":function(t,e,a){"use strict";var n=a("9c0c"),o=a.n(n);o.a},6058:function(t,e,a){},"6b54":function(t,e,a){},"79b8":function(t,e,a){},"7fe3":function(t,e,a){},8271:function(t,e,a){},"8b6e":function(t,e,a){},9769:function(t,e,a){"use strict";var n=a("48f0"),o=a.n(n);o.a},"979a":function(t,e,a){"use strict";var n=a("8b6e"),o=a.n(n);o.a},"9a83":function(t,e,a){"use strict";var n=a("6b54"),o=a.n(n);o.a},"9c0c":function(t,e,a){},"9e22":function(t,e,a){"use strict";var n=a("f3de"),o=a.n(n);o.a},"9fd7":function(t,e,a){},a18b:function(t,e,a){},b4fe:function(t,e,a){"use strict";var n=a("a18b"),o=a.n(n);o.a},bf51:function(t,e,a){"use strict";var n=a("9fd7"),o=a.n(n);o.a},bfd3:function(t,e,a){},c4ff:function(t,e,a){},cd49:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n,o,r=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("app-alert",{attrs:{alert:t.alertState.alert,dismiss:t.alertActions.dismissAlert}}),a("app-navbar",{attrs:{hide:t.appState.factoryFormOpen||t.appState.selectFactoryMode,fixed:!0},on:{menu:t.modalActions.toggleSidebar}},[t._v("農地工廠回報")]),a("app-sidebar",{model:{value:t.modalState.sidebarOpen,callback:function(e){t.$set(t.modalState,"sidebarOpen",e)},expression:"modalState.sidebarOpen"}}),a("filter-modal",{attrs:{open:t.modalState.filterModalOpen,dismiss:t.modalActions.closeFilterModal}}),a("create-factory-success-modal",{attrs:{open:t.modalState.createFactorySuccessModal,dismiss:t.modalActions.closeCreateFactorySuccessModal}}),a("update-factory-success-modal",{attrs:{open:t.modalState.updateFactorySuccessModal,dismiss:t.modalActions.closeUpdateFactorySuccessModal}}),a("about-modal",{attrs:{open:t.modalState.aboutModalOpen,dismiss:t.modalActions.closeAboutModal}}),a("contact-modal",{attrs:{open:t.modalState.contactModalOpen,dismiss:t.modalActions.closeContactModal}}),a("getting-started-modal",{attrs:{open:t.modalState.gettingStartedModalOpen,dismiss:t.modalActions.closeGettingStartedModal}}),a("safety-modal",{attrs:{open:t.modalState.safetyModalOpen,dismiss:t.modalActions.closeSafetyModal}}),a("tutorial-modal",{attrs:{open:t.modalState.tutorialModalOpen,dismiss:t.modalActions.closeTutorialModal}}),a("Map",{attrs:{openCreateFactoryForm:t.appActions.openCreateFactoryForm,openEditFactoryForm:t.appActions.openEditFactoryForm,selectFactoryMode:t.appState.selectFactoryMode,enterSelectFactoryMode:t.appActions.enterSelectFactoryMode,exitSelectFactoryMode:t.appActions.exitSelectFactoryMode,setFactoryLocation:t.appActions.setFactoryLocation,openFilterModal:t.modalActions.openFilterModal}}),t.appState.factoryFormOpen?a("form-page",{attrs:{mode:t.appState.formMode,factoryData:t.appState.factoryData,close:t.appActions.closeFactoryPage,selectFactoryMode:t.appState.selectFactoryMode,enterSelectFactoryMode:t.appActions.enterSelectFactoryMode,exitSelectFactoryMode:t.appActions.exitSelectFactoryMode,factoryLocation:t.appState.factoryLocation,setCreateFactorySuccessModal:t.setCreateFactorySuccessModal}}):t._e()],1)},c=[],s=a("e587"),l=a("750b"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.selectFactoryMode?a("div",{staticClass:"navbar-container"},[a("app-navbar",{attrs:{dark:!1,fixed:!0},on:{back:t.onNavBack,menu:t.modalActions.toggleSidebar}},[t._v(" 新增資訊 ")])],1):t._e(),a("div",{staticClass:"map-container"},[a("div",{ref:"root",staticClass:"map"}),a("div",{ref:"popup",class:["popup",{show:t.popupState.show}],style:{borderColor:t.popupData.color}},[a("div",{staticClass:"close",attrs:{"data-label":"map-popup-close"},on:{click:function(e){t.popupState.show=!1}}}),a("small",{style:{color:t.popupData.color}},[t._v(t._s(t.popupData.status))]),a("h3",[t._v(t._s(t.popupData.name))]),a("p",{staticClass:"summary"},[t._v(t._s(t.popupData.summary))]),a("app-button",{attrs:{outline:"",color:t.getButtonColorFromStatus(),"data-label":"map-popup-modify"},on:{click:t.onClickEditFactoryData}},[t._v(" 補充資料 ")])],1),t.selectFactoryMode?a("div",{staticClass:"region-alert"},[t._v(" 白色區域：農地範圍，為可回報範圍。"),a("br"),t._v("灰色區域：非農地範圍，不在回報範圍內。 ")]):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.selectFactoryMode,expression:"!selectFactoryMode"}],staticClass:"ol-map-search ol-unselectable ol-control",attrs:{"data-label":"map-search"},on:{click:t.openFilterModal}},[t._m(0)]),a("div",{staticClass:"ol-fit-location ol-unselectable ol-control",attrs:{"data-label":"map-locate"},on:{click:t.zoomToGeolocation}},[t._m(1)]),t.selectFactoryMode&&!t.locationTooltipVisibility?a("div",{staticClass:"center-point"}):t._e(),t.selectFactoryMode&&t.showLocationInput?a("div",{staticClass:"location-tooltip-backdrop",on:{click:t.dismissLocationInput}}):t._e(),t.selectFactoryMode&&t.locationTooltipVisibility?a("div",{staticClass:"location-tooltip"},[a("div",{staticClass:"circle"}),a("div",{staticClass:"line"}),t.showLocationInput?t._e():a("div",{staticClass:"box flex justify-between"},[a("p",[t._v(" 經度："+t._s(t.factoryLngLat[0].toFixed(7))+" "),a("br"),t._v(" 緯度："+t._s(t.factoryLngLat[1].toFixed(7))+" "),a("br"),a("small",[t._v("以上經緯度版本為WGS84")])]),a("div",{staticClass:"flex align-items-end"},[a("app-button",{attrs:{color:"white",small:""},on:{click:t.onClickLocationSearch}},[t._v("搜尋經緯度")])],1)]),t.showLocationInput?a("div",{staticClass:"box box-input flex flex-column"},[a("div",[a("label",[t._v("經度：")]),a("app-text-field",{attrs:{type:"number",placeholder:"請輸入經度。例：121.5253618",small:""},model:{value:t.inputLongitude,callback:function(e){t.inputLongitude=e},expression:"inputLongitude"}})],1),a("div",[a("label",[t._v("緯度：")]),a("app-text-field",{attrs:{type:"number",placeholder:"請輸入緯度。例：25.0459660",small:""},model:{value:t.inputLatitude,callback:function(e){t.inputLatitude=e},expression:"inputLatitude"}})],1),a("div",{staticStyle:{"text-align":"center"}},[a("app-button",{attrs:{color:"white",small:"",auto:""},on:{click:t.onClickSubmitLocation}},[t._v("定位")])],1)]):t._e()]):t._e(),a("div",{staticClass:"factory-button-group"},[a("div",{staticClass:"factory-secondary-actions-group"},[t.selectFactoryMode?t._e():a("div",{staticClass:"ol-switch-luilayer-visibility ol-unselectable ol-control",attrs:{"data-label":"map-set-luilayer-visibility"},on:{click:t.toggleLUILayerVisibility}},[a("button",[t._v(" "+t._s(t.setLUILayerVisibilityText)+" ")])]),a("div",{staticClass:"ol-switch-base ol-unselectable ol-control",attrs:{"data-label":"map-switch-base"},on:{click:t.switchBaseMap}},[a("button",[t._v(" "+t._s(t.baseMapName)+" ")])]),t.selectFactoryMode?a("div",{staticClass:"ol-switch-base ol-unselectable ol-control",attrs:{"data-label":"map-location-tooltip"},on:{click:t.toggleLocationTooltipVisibility}},[a("button",[t._v(" "+t._s(t.locationTooltipControlText)+" ")])]):t._e()]),t.selectFactoryMode?t._e():a("div",{staticClass:"create-factory-button"},[a("app-button",{attrs:{"data-label":"map-create-factory",color:"dark-green"},on:{click:t.onClickCreateFactoryButton}},[t._v("我想新增可疑工廠")])],1),t.selectFactoryMode?a("div",{staticClass:"choose-location-button"},[a("app-button",{attrs:{"data-label":"map-select-position",color:"dark-green"},on:{click:t.onClickFinishSelectFactoryPositionButton}},[t._v(" 選擇此地點 ")])],1):t._e()])])])},p=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",[a("img",{attrs:{src:"/images/filter.svg",alt:"search"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",[a("img",{attrs:{src:"/images/locate.svg",alt:"locate"}})])}],d=(a("d81d"),a("acd8"),a("2fa7")),f=(a("96cf"),a("9ab4")),m=function(){var t,e=this,a=e.$createElement,n=e._self._c||a;return n("button",{class:Object.assign({},{outline:e.outline,disabled:e.disabled,rect:e.rect,small:e.small,auto:e.auto},(t={},t[e.color]=!0,t)),on:{click:e.click}},[e._t("default")],2)},v=[],b=Object(l["b"])({name:"AppButton",props:{outline:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rect:{type:Boolean,default:!1},color:{type:String,default:"default"},small:{type:Boolean,default:!1},auto:{type:Boolean,default:!1}},setup:function(t,e){var a=function(){t.disabled||e.emit("click")};return{click:a}}}),g=b,y=(a("bf51"),a("2877")),h=Object(y["a"])(g,m,v,!1,null,"a2769d84",null),_=h.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{class:{dark:t.dark,fixed:t.fixed,hide:t.hide}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.dark,expression:"!dark"}],staticClass:"back-button",attrs:{"data-label":"navbar-back"},on:{click:function(e){return t.onBackClick()}}},[a("span"),a("span"),a("span")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.dark,expression:"dark"}],staticClass:"back-placeholder"}),t._t("default"),a("div",{staticClass:"menu-button",attrs:{"data-label":"navbar-menu"},on:{click:function(e){return t.onMenuClick()}}},[a("span"),a("span"),a("span")])],2)},w=[],S=Object(l["b"])({name:"AppNavbar",props:{dark:{type:Boolean,default:!0},fixed:{type:Boolean,default:!1},back:{type:Function},hide:{type:Boolean,default:!1}},setup:function(t,e){var a=e.emit;return{onBackClick:function(){a("back")},onMenuClick:function(){a("menu")}}}}),F=S,M=(a("4f2d"),Object(y["a"])(F,O,w,!1,null,"63ab578c",null)),k=M.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return"checkbox"===t.type?a("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],class:{small:t.small},attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.inputValue)?t._i(t.inputValue,null)>-1:t.inputValue},on:{change:function(e){var a=t.inputValue,n=e.target,o=!!n.checked;if(Array.isArray(a)){var r=null,i=t._i(a,r);n.checked?i<0&&(t.inputValue=a.concat([r])):i>-1&&(t.inputValue=a.slice(0,i).concat(a.slice(i+1)))}else t.inputValue=o}}},"input",t.$attrs,!1)):"radio"===t.type?a("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],class:{small:t.small},attrs:{type:"radio"},domProps:{checked:t._q(t.inputValue,null)},on:{change:function(e){t.inputValue=null}}},"input",t.$attrs,!1)):a("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],class:{small:t.small},attrs:{type:t.type},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}},"input",t.$attrs,!1))},j=[],E=Object(l["b"])({name:"AppTextField",props:{type:{type:String,default:"text"},value:{type:String,required:!0},small:{type:Boolean,default:!1}},setup:function(t,e){var a=Object(l["a"])({get:function(){return t.value},set:function(t){return e.emit("input",t)}});return{inputValue:a}}}),C=E,A=(a("e405"),Object(y["a"])(C,x,j,!1,null,"e9035d54",null)),L=A.exports,I=(a("4de4"),a("4160"),a("caad"),a("13d5"),a("4ec9"),a("a9e3"),a("9129"),a("4fad"),a("d3b7"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),a("284c")),T=a("9f12"),P=a("53fe"),B=a("4cdf"),U=a("a2c7"),N=a("5eee"),G=a("6c77"),R=a("6cbf"),V=a("ce2c"),D=a("83a6"),$=a("8682"),z=a("82b0"),q=a("f403"),X=a("d510"),W=a("6ed8"),H=a("256f"),Z=a("0af5"),J=a("3e6b"),Y=a("480c"),K=a("5831"),Q=a("d0e9"),tt=a("e29f"),et=a("9d47"),at=a("a7f7"),nt=a("f53f"),ot=a("3a39"),rt=a("508e"),it=[{value:"2-1",text:"金屬: 沖床、銑床、車床、鏜孔"},{value:"2-2",text:"金屬: 焊接、鑄造、熱處理"},{value:"2-3",text:"金屬: 金屬表面處理、噴漆"},{value:"3",text:"塑膠加工、射出"},{value:"4",text:"橡膠加工"},{value:"5",text:"非金屬礦物（石材）"},{value:"6",text:"食品"},{value:"7",text:"皮革"},{value:"8",text:"紡織"},{value:"9",text:"其他"}];(function(t){t["NEW"]="NEW",t["EXISTING_INCOMPLETE"]="EXISTING_INCOMPLETE",t["EXISTING_COMPLETE"]="EXISTING_COMPLETE",t["REPORTED"]="REPORTED"})(o||(o={}));var ct,st=(n={},Object(d["a"])(n,o.NEW,["民眾回報工廠"]),Object(d["a"])(n,o.EXISTING_COMPLETE,["政府盤查工廠"]),Object(d["a"])(n,o.EXISTING_INCOMPLETE,["政府盤查工廠","資料不齊"]),Object(d["a"])(n,o.REPORTED,["已舉報違章工廠"]),n),lt=[o.NEW,o.EXISTING_COMPLETE,o.EXISTING_INCOMPLETE,o.REPORTED],ut=(a("a630"),a("fb6a"),a("45fc"),window.OffscreenCanvas?new OffscreenCanvas(500,500):document.createElement("canvas")),pt=ut.getContext("2d"),dt=function(t){return function(e){return new Promise((function(a){var n=new Image;n.crossOrigin="",n.src=e,n.style.display="none",n.onload=function(){return Object(f["a"])(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var o,r,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return ut.width=n.width,ut.height=n.height,pt.clearRect(0,0,ut.width,ut.height),pt.drawImage(n,0,0),o=pt.getImageData(0,0,n.width,n.height),r=o.data,e.next=8,Promise.resolve(t(r));case 8:i=document.createElement("canvas"),c=i.getContext("2d"),i.width=n.width,i.height=n.height,c.putImageData(o,0,0),a(i.toDataURL()),n.remove(),i.remove();case 16:case"end":return e.stop()}}),e)})))}}))}},ft=(dt((function(t){for(var e=0;e<t.length;e+=4){var a=(t[e]+t[e+1]+t[e+2])/3;t[e]=a,t[e+1]=a,t[e+2]=a}})),[[255,241,0]]),mt=function(t,e){return!t.some((function(t,a){return e[a]!==t}))},vt=function(t){return ft.some((function(e){return mt(e,t)}))},bt=dt((function(t){for(var e=0;e<t.length;e+=4){var a=Array.from(t.slice(e,e+3));vt(a)?(t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=1):(t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=255)}})),gt=a("d202"),yt=function(t){return"/images/marker-".concat(t,".svg")},ht=function(t){var e;return(e={},Object(d["a"])(e,o.NEW,"#447287"),Object(d["a"])(e,o.EXISTING_COMPLETE,"#58585B"),Object(d["a"])(e,o.EXISTING_INCOMPLETE,"#58585B"),Object(d["a"])(e,o.REPORTED,"#6D8538"),e)[t]};function _t(t){return"B"===t.cet_report_status?o.REPORTED:t.before_release?t.data_complete?o.EXISTING_COMPLETE:o.EXISTING_INCOMPLETE:o.NEW}(function(t){t[t["OSM"]=0]="OSM",t[t["TAIWAN"]=1]="TAIWAN",t[t["SATELITE"]=2]="SATELITE"})(ct||(ct={}));var Ot=function(){return Object.entries({zoomIn:"/images/zoom-in.svg",zoomOut:"/images/zoom-out.svg"}).reduce((function(t,e){var a=Object(s["a"])(e,2),n=a[0],o=a[1],r=document.createElement("img");return r.setAttribute("src",o),Object.assign(Object.assign({},t),Object(d["a"])({},n,r))}),{})},wt=Object.entries(o).reduce((function(t,e){var a=Object(s["a"])(e,2),n=a[0],o=a[1];return Object.assign(Object.assign({},t),Object(d["a"])({},n,new G["b"]({image:new R["a"]({anchorYUnits:z["a"].PIXELS,anchorOrigin:gt["a"].BOTTOM_LEFT,src:yt(o)})})))}),{}),St=new G["b"]({}),Ft=new G["b"]({image:new V["a"]({fill:new D["a"]({color:"#A22929"}),radius:12,stroke:new $["a"]({color:"#FFFFFF",width:1})})}),Mt=function(){function t(e){Object(T["a"])(this,t),this.appliedFilters=[o.NEW,o.EXISTING_INCOMPLETE,o.EXISTING_COMPLETE,o.REPORTED],this.factoryMap=new Map,this._map=e}return Object(P["a"])(t,[{key:"getFactory",value:function(t){return this.factoryMap.get(t)}},{key:"updateFactory",value:function(t,e){this.factoryMap.set(t,e);var a=this.factoriesLayerSource.getFeatureById(t);a&&a.setStyle(this.getFactoryStyle(e))}},{key:"addFactories",value:function(t){var e=this,a=this.createFactoryFeature.bind(this),n=t.filter((function(t){return!e.factoryMap.has(t.id)})).map(a);this.factoriesLayerSource.addFeatures(n),t.forEach((function(t){return e.updateFactory(t.id,t)}))}},{key:"hideFactories",value:function(t){var e=this;t.forEach((function(t){var a=e.factoriesLayerSource.getFeatureById(t.id);a.setStyle(St)}))}},{key:"setFactoryStatusFilter",value:function(t){this.appliedFilters=t,this.updateFactoriesFeatureStyle()}},{key:"isFactoryVisible",value:function(t){return this.appliedFilters.includes(_t(t))}},{key:"getFactoryStyle",value:function(t){var e=this.isFactoryVisible(t);return e?wt[_t(t)]:St}},{key:"createFactoryFeature",value:function(t){var e=new B["a"]({geometry:new q["a"](Object(H["i"])([t.lng,t.lat],"EPSG:4326","EPSG:3857"))});return e.setId(t.id),e.setStyle(this.getFactoryStyle(t)),e}},{key:"forEachFeatureFactory",value:function(t){var e=this;this.factoriesLayerSource.getFeatures().forEach((function(a){var n=a.getId(),o=e.factoryMap.get(n);t(a,o)}))}},{key:"displayAllFactory",value:function(){this.forEachFeatureFactory((function(t,e){t.setStyle(wt[_t(e)])}))}},{key:"updateFactoriesFeatureStyle",value:function(){var t=this;this.forEachFeatureFactory((function(e,a){e.setStyle(t.getFactoryStyle(a))}))}},{key:"mapInstance",get:function(){return this._map}},{key:"factories",get:function(){return Object(I["a"])(this.factoryMap.values())}},{key:"factoriesLayerSource",get:function(){if(!this._factoriesLayerSource){this._factoriesLayerSource=new K["a"]({features:[]});var t=new J["a"]({source:this._factoriesLayerSource,zIndex:3});this.mapInstance.map.addLayer(t)}return this._factoriesLayerSource}}]),t}(),kt=function(){for(var t=Object(H["d"])("EPSG:3857"),e=t.getExtent(),a=new Array(21),n=Object(Z["E"])(e)/256,o=new Array(21),r=0;r<21;++r)a[r]=n/Math.pow(2,r),o[r]=r;return new W["b"]({origin:Object(Z["C"])(e),resolutions:a,matrixIds:o})},xt=function(t,e){var a=function(){switch(t){case ct.OSM:return new Q["a"]({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'});case ct.TAIWAN:return new X["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts",layer:"EMAP",tileGrid:e,crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});case ct.SATELITE:return new X["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/PHOTO_MIX/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"EMAP",tileGrid:e,requestEncoding:"REST",crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});default:return new Q["a"]({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'})}}();return new Y["a"]({source:a,opacity:.6,zIndex:1})},jt=function(t){return new Y["a"]({source:new X["a"]({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/nURBAN2/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"LUIMAP",requestEncoding:"REST",tileGrid:t,tileLoadFunction:function(t,e){var a=t.getImage();bt(e).then((function(t){a.src=t}))},crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'}),opacity:.5,zIndex:2})},Et=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(T["a"])(this,t),this.tileGrid=kt(),this.hasInitialLocation=!1,this.mapDom=e,this.baseLayer=xt(ct.OSM,this.tileGrid),this._map=this.instantiateOLMap(this.mapDom,this.baseLayer,n),n.minimap||(this.geolocation=this.setupGeolocationTracking(this._map)),this.setupEventListeners(this._map,a)}return Object(P["a"])(t,[{key:"setupEventListeners",value:function(t,e){var a=this,n=function(){return Object(f["a"])(a,void 0,void 0,regeneratorRuntime.mark((function a(){var n,o,r,i,c,l,u,p,d,f,m,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.getView(),o=n.getZoom(),r=n.getResolutionForZoom(o),i=Math.ceil(r/2),c=Object(H["i"])(n.getCenter(),"EPSG:3857","EPSG:4326"),l=Object(s["a"])(c,2),u=l[0],p=l[1],!e.onMoved){a.next=11;break}return d=this.mapDom.getBoundingClientRect(),f=d.width,m=d.height,a.next=9,this.canPlaceFactory([f/2,m/2]);case 9:v=a.sent,e.onMoved([u,p,i,o],v);case 11:case"end":return a.stop()}}),a,this)})))};t.on("change:resolution",n),t.on("moveend",n),t.on("zoomend",(function(){var a=t.getView(),n=a.getZoom();e.onZoomed&&e.onZoomed(n)})),t.on("click",(function(n){return Object(f["a"])(a,void 0,void 0,regeneratorRuntime.mark((function a(){var o,r,i,c,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.onClicked&&(o=Object(H["i"])(n.coordinate,"EPSG:3857","EPSG:4326"),r=Object(s["a"])(o,2),i=r[0],c=r[1],l=t.forEachFeatureAtPixel(n.pixel,(function(t){return t}),{layerFilter:function(t){return 5!==t.getZIndex()}}),e.onClicked([i,c],l));case 1:case"end":return a.stop()}}),a)})))})),this.getLUIMAPLayer().then((function(t){t.on("change:visible",(function(){e.onLUILayerVisibilityChange&&e.onLUILayerVisibilityChange(t.getVisible())}))}))}},{key:"setCoordinate",value:function(t,e,a){var n=this.map.getView();a=a||n.getZoom(),n.setCenter(Object(H["i"])([t,e],"EPSG:4326","EPSG:3857")),n.setZoom(a)}},{key:"instantiateOLMap",value:function(t,e){var a,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=kt();if(o.getInitialLocation&&(n=o.getInitialLocation())){var i=n,c=Object(s["a"])(i,3),l=c[0],u=c[1],p=c[2];a=new U["a"]({center:Object(H["i"])([l,u],"EPSG:4326","EPSG:3857"),zoom:p}),this.hasInitialLocation=!0}else a=new U["a"]({center:Object(H["i"])([120.1,23.234],"EPSG:4326","EPSG:3857"),zoom:16});var d=Ot(),f={target:t,layers:[e,jt(r)],view:a,controls:[new tt["a"]({zoomInLabel:d.zoomIn,zoomOutLabel:d.zoomOut}),new et["a"],new at["a"]],interactions:Object(ot["a"])({pinchRotate:!1}).extend([new rt["a"]({threshold:.4})])};return o.minimap&&(f.controls=[],f.interactions=[]),new N["a"](f)}},{key:"setupGeolocationTracking",value:function(t){var e=t.getView(),a=new nt["a"]({trackingOptions:{enableHighAccuracy:!0},projection:e.getProjection()});a.setTracking(!0);var n=this.setupGeolocationLayer(a);return t.addLayer(n),a}},{key:"setupGeolocationLayer",value:function(t){var e=this,a=new B["a"],n=function(t){return Number.isNaN(t)?new G["b"]({image:new V["a"]({fill:new D["a"]({color:"#0099ff"}),stroke:new $["a"]({color:"#fff",width:3}),radius:15})}):new G["b"]({image:new R["a"]({anchor:[.5,.5],src:"/images/now.svg",rotation:t,rotateWithView:!0})})};a.setStyle(n(NaN)),t.on("change:position",(function(){var e=t.getPosition();a.setGeometry(e?new q["a"](e):void 0)})),t.on("change:heading",(function(){var e;a.setStyle(n((e=t.getHeading(),null!==e&&void 0!==e?e:NaN)))}));var o=new B["a"];t.on("change:accuracyGeometry",(function(){o.setGeometry(t.getAccuracyGeometry())}));var r=this.hasInitialLocation;t.on("change",(function(){if(!r){var a=t.getPosition();a&&(e.zoomToGeolocation(),r=!0)}}));var i=new J["a"]({source:new K["a"]({features:[a,o]}),zIndex:5});return i}},{key:"zoomToGeolocation",value:function(){if(!this.geolocation)throw new Error("No location permission");var t=this.geolocation.getPosition();if(!t)throw new Error("No location permission");var e=this._map.getView();e.setCenter(t),e.setZoom(16)}},{key:"changeBaseMap",value:function(t){this._map.removeLayer(this.baseLayer),this.baseLayer=xt(t,this.tileGrid),this._map.addLayer(this.baseLayer)}},{key:"canPlaceFactory",value:function(t){var e=this;return new Promise((function(a){e._map.forEachLayerAtPixel(t,(function(t,e){var n=Object(s["a"])(e,4),o=n[3];return a(1===o)}),{layerFilter:function(t){return"LUIMAP"===t.getProperties().source.layer_}}),a(!1)}))}},{key:"getLUIMAPLayer",value:function(){var t=this;return new Promise((function(e,a){var n;t._map.getLayers().forEach((function(t){"LUIMAP"===t.getProperties().source.layer_&&(n=t,e(t))})),n||a(new TypeError("LUIMAP Layer not found"))}))}},{key:"setLUILayerVisible",value:function(t){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getLUIMAPLayer();case 2:a=e.sent,a.setVisible(t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getLUILayerVisible",value:function(){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getLUIMAPLayer();case 2:return e=t.sent,t.abrupt("return",e.getVisible());case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setMinimapPin",value:function(t,e){var a=Object(H["i"])([t,e],"EPSG:4326","EPSG:3857");if(this.minimapPinFeature)this.minimapPinFeature.setGeometry(new q["a"](a));else{var n=new B["a"]({geometry:new q["a"](a)});n.setStyle(Ft),this.minimapPinFeature=n;var o=new K["a"]({features:[n]}),r=new J["a"]({source:o,zIndex:4});this.map.addLayer(r)}this._map.getView().setCenter(a)}},{key:"map",get:function(){return this._map}}]),t}();function Ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=new Et(t,e,a);return window.changeBaseMap=n.changeBaseMap.bind(n),new Mt(n)}function At(t,e){var a=new Et(t,{},{minimap:!0});return a.map.getView().setCenter(e),new Mt(a)}a("99af"),a("9911"),a("2b3d");var Lt=a("bc3a"),It=a.n(Lt),Tt=a("9663"),Pt=a.n(Tt),Bt="https://staging.disfactory.tw/api",Ut=It.a.create({baseURL:Bt,headers:{"Content-Type":"application/json"}});function Nt(t,e,a){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ut.get("/factories?range=".concat(t,"&lng=").concat(e,"&lat=").concat(a));case 3:return o=n.sent,r=o.data,n.abrupt("return",r);case 8:throw n.prev=8,n.t0=n["catch"](0),console.error(n.t0),new TypeError("Get factory failed");case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))}var Gt="39048813b021935";function Rt(t){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("image",t),e.next=4,It()({method:"POST",url:"https://api.imgur.com/3/image",data:a,headers:{"Content-Type":"multipart/form-data",Authorization:"Client-ID ".concat(Gt)}});case 4:return n=e.sent,o=n.data,e.abrupt("return",{link:o.data.link,file:t});case 7:case"end":return e.stop()}}),e)})))}var Vt=function(t){return t[0]+t[1]/60+t[2]/3600};function Dt(t){var e=new FileReader;return new Promise((function(a){e.onload=function(t){if(t.target){var e=Pt.a.readFromBinaryFile(t.target.result),n={};e.GPSLatitude&&(n.Latitude=Vt(e.GPSLatitude)),e.GPSLongitude&&(n.Longitude=Vt(e.GPSLongitude)),e.DateTimeOriginal&&(n.DateTimeOriginal=e.DateTimeOriginal),a(n)}else a({})},e.readAsArrayBuffer(t)}))}function $t(t){var e=t.link,a=t.file;return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dt(a);case 2:return n=t.sent,t.next=5,Ut.post("/images",Object.assign({url:e},n));case 5:return o=t.sent,r=o.data,t.abrupt("return",{token:r.token,src:URL.createObjectURL(a)});case 8:case"end":return t.stop()}}),t)})))}function zt(t){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(Array.from(t).map((function(t){return Rt(t).then((function(t){return $t(t)}))}))));case 1:case"end":return e.stop()}}),e)})))}function qt(t,e,a){var n=a.nickname,o=a.contact;return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function a(){var r=this;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",Promise.all(Array.from(e).map((function(e){return Rt(e).then((function(e){return function(){return Object(f["a"])(r,void 0,void 0,regeneratorRuntime.mark((function a(){var r,i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Dt(e.file);case 2:return r=a.sent,a.next=5,Ut.post("/factories/".concat(t,"/images"),Object.assign(Object.assign({url:e.link},r),{nickname:n,contact:o}));case 5:return i=a.sent,c=i.data,c.image_path=e.link,a.abrupt("return",c);case 9:case"end":return a.stop()}}),a)})))}()}))}))));case 1:case"end":return a.stop()}}),a)})))}function Xt(t){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ut.post("/factories",JSON.stringify(t));case 3:return a=e.sent,n=a.data,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error(e.t0),new TypeError("Create factory failed");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))}function Wt(t,e){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Ut.put("/factories/".concat(t),JSON.stringify(e));case 3:return n=a.sent,o=n.data,a.abrupt("return",o);case 8:throw a.prev=8,a.t0=a["catch"](0),console.error(a.t0),new TypeError("Update factory failed");case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))}a("a4d3"),a("e01a");var Ht=Symbol("MAIN_MAP_CONTROLLER"),Zt=a("0710"),Jt=a("698f");function Yt(t){var e=function(e){"backPressed"===e.state&&t()};window.history.pushState("backPressed","",null),window.history.pushState("dummy","",null),window.addEventListener("popstate",e,{once:!0}),Object(l["f"])((function(){window.removeEventListener("popstate",e)}))}var Kt=Symbol("GASymbol");function Qt(t){Object(l["g"])(Kt,t.root.$gtag)}function te(){var t=Object(l["d"])(Kt);if(!t)throw new Error("use provideGA before useGA");var e=function(e){t.pageview({page_path:e})},a=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.event(e,a)};return{pageview:e,event:a}}var ee,ae=Symbol("ModalStateSymbol"),ne=function(){var t=Object(l["h"])({updateFactorySuccessModal:!1,createFactorySuccessModal:!1,aboutModalOpen:!1,contactModalOpen:!1,safetyModalOpen:!1,gettingStartedModalOpen:"true"!==localStorage.getItem("use-app"),tutorialModalOpen:!1,sidebarOpen:!1,filterModalOpen:!1});return Object(l["g"])(ae,t),t},oe=function(){var t=Object(l["d"])(ae);if(!t)throw new Error("Use useModalState before provideModalState");var e=te(),a=e.event,n=function(){t.updateFactorySuccessModal=!0},o=function(){t.updateFactorySuccessModal=!1},r=function(){t.createFactorySuccessModal=!0},i=function(){t.createFactorySuccessModal=!1},c=function(){t.aboutModalOpen=!0},s=function(){t.aboutModalOpen=!1},u=function(){t.contactModalOpen=!0},p=function(){t.contactModalOpen=!1},d=function(){t.safetyModalOpen=!0},f=function(){t.safetyModalOpen=!1},m=function(){t.gettingStartedModalOpen=!0},v=function(){t.gettingStartedModalOpen=!1},b=function(){t.tutorialModalOpen=!0},g=function(){t.tutorialModalOpen=!1},y=function(){var e=!t.sidebarOpen;a("toggleSidebar",{target:e}),t.sidebarOpen=e},h=function(){a("closeFilterModal"),t.filterModalOpen=!1},_=function(){a("openFilterModal"),t.filterModalOpen=!0},O={openUpdateFactorySuccessModal:n,closeUpdateFactorySuccessModal:o,openCreateFactorySuccessModal:r,closeCreateFactorySuccessModal:i,openAboutModal:c,closeAboutModal:s,openContactModal:u,closeContactModal:p,openSafetyModal:d,closeSafetyModal:f,openGettingStartedModal:m,closeGettingStartedModal:v,openTutorialModal:b,closeTutorialModal:g,toggleSidebar:y,openFilterModal:_,closeFilterModal:h};return[t,O]},re=(a("7db0"),a("a15b"),a("b0c0"),Symbol("FactoryPopup")),ie=function(){var t=Object(l["h"])({show:!1});return Object(l["g"])(re,t),[t]},ce=function(){var t=Object(l["d"])(re);return[t]},se=function(t){var e=t.images.length>0?"已有照片":"缺照片",a=it.find((function(e){return e.value===t.type})),n=a&&a.text||"其他";return n.includes("金屬")&&(n="金屬"),[e,n].filter(Boolean).join("\n")},le=function(t){var e=_t(t);return{id:t.id,name:t.name,color:ht(e),status:st[e][0],summary:se(t)}},ue=Symbol("AppState"),pe=function(){var t=Object(l["h"])({formMode:"create",factoryFormOpen:!1,factoryData:null,factoryLocation:[],selectFactoryMode:!1});return Object(l["g"])(ue,t),[t]},de=function(t){var e=te(),a=e.event,n=e.pageview;return{updateFactoryData:function(e){t.factoryData=e},openCreateFactoryForm:function(){t.factoryData=null,t.formMode="create",t.factoryFormOpen=!0,n("/create")},openEditFactoryForm:function(e){t.factoryData=e,t.formMode="edit",t.factoryFormOpen=!0,n("/edit")},closeFactoryPage:function(){t.factoryFormOpen=!1,a("closeFactoryPage")},setFactoryLocation:function(e){t.factoryLocation=e,a("setFactoryLocation")},enterSelectFactoryMode:function(){t.selectFactoryMode=!0,a("enterSelectFactoryMode")},exitSelectFactoryMode:function(){t.selectFactoryMode=!1,a("exitSelectFactoryMode")}}},fe=function(){var t=Object(l["d"])(ue);return[t,de(t)]},me=Symbol("AlertState");(function(t){t["info"]="info",t["warn"]="warn",t["error"]="error"})(ee||(ee={}));var ve=function(){var t=Object(l["h"])({alert:null});return Object(l["g"])(me,t),[t]},be=function(t){return{showAlert:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ee.warn,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"此錯誤訊息將在3秒後消失。";t.alert={title:e,level:n,dismissText:o},t.timeout=window.setTimeout((function(){t.alert=null,t.timeout=void 0}),a)},dismissAlert:function(){t.alert=null,t.timeout&&(window.clearTimeout(t.timeout),t.timeout=void 0)}}},ge=function(){var t=Object(l["d"])(me);return[t,be(t)]},ye=(a("b680"),a("ac1f"),["lat","lng","zoom"]),he=new(function(){function t(){Object(T["a"])(this,t),this.s={},this.lng=this.defineGetterSetter("lng"),this.lat=this.defineGetterSetter("lat"),this.zoom=this.defineGetterSetter("zoom")}return Object(P["a"])(t,[{key:"load",value:function(t){var e=/^#map=([\d.]+)\/([\d.]+)\/([\d.]+)$/.exec(t.hash);null!==e&&(this.s.zoom=parseFloat(e[1]),this.s.lng=parseFloat(e[2]),this.s.lat=parseFloat(e[3]))}},{key:"dumps",value:function(){var t,e=this;return ye.some((function(t){return"undefined"===typeof e.s[t]}))?"":"#map=".concat(null===(t=this.s.zoom)||void 0===t?void 0:t.toFixed(2),"/").concat(this.s.lng,"/").concat(this.s.lat)}},{key:"defineGetterSetter",value:function(t){var e=this;return function(){return arguments.length>0&&(e.s[t]=arguments.length<=0?void 0:arguments[0]),e.s[t]}}}]),t}()),_e=Object(l["b"])({components:{AppButton:_,AppNavbar:k,AppTextField:L},props:{openCreateFactoryForm:{type:Function,required:!0},openEditFactoryForm:{type:Function,required:!0},selectFactoryMode:{type:Boolean,required:!0},enterSelectFactoryMode:{type:Function,required:!0},exitSelectFactoryMode:{type:Function,required:!0},setFactoryLocation:{type:Function,required:!0},openFilterModal:{type:Function,required:!0}},setup:function(t){var e,a,n=te(),r=n.event,i=Object(l["i"])(null),c=Object(l["i"])(null),u=Object(l["i"])(!1),p=Object(l["i"])([]),m=Object(l["d"])(Ht,Object(l["i"])()),v=oe(),b=Object(s["a"])(v,2),g=b[1],y=fe(),h=Object(s["a"])(y,1),_=h[0],O=ge(),w=Object(s["a"])(O,2),S=w[1],F=ce(),M=Object(s["a"])(F,1),k=M[0],x=Object(l["a"])((function(){return _.factoryData?le(_.factoryData):{}})),j=Object(l["i"])(0),E=Object(l["a"])((function(){return"切換不同地圖"})),C=Object(l["i"])((null===(a=null===(e=m)||void 0===e?void 0:e.value)||void 0===a?void 0:a.mapInstance.getLUILayerVisible())||!1),A=Object(l["a"])((function(){return C.value?"隱藏農地範圍":"顯示農地範圍"})),L=function(){var t,e,a=!C.value;null===(e=null===(t=m)||void 0===t?void 0:t.value)||void 0===e||e.mapInstance.setLUILayerVisible(a)},I=function(t){if(m.value){var e=m.value.getFactory(t);e&&(_.factoryData=e,k.show=!0)}},T=function(){_.factoryData&&t.openEditFactoryForm(_.factoryData)},P=Object(l["i"])(!1),B=Object(l["i"])(!1),U=function(){P.value=!P.value},N=Object(l["a"])((function(){return P.value?"隱藏經緯度":"顯示經緯度"})),G=Object(l["i"])(""),R=Object(l["i"])(""),V=function(){B.value=!0},D=function(){B.value=!1},$=function(){if(m.value){var t=parseFloat(G.value),e=parseFloat(R.value);if(!G.value||!R.value||isNaN(t)||isNaN(e))D();else{var a=m.value.mapInstance.map.getView().getZoom();(!a||a<=17)&&(a=17),m.value.mapInstance.setCoordinate(t,e,a),D()}}};Object(l["e"])((function(){var t=new Zt["a"]({element:c.value,positioning:Jt["a"].BOTTOM_LEFT}),e=Ct(i.value,{onMoved:function(t,a){var n=Object(s["a"])(t,4),o=n[0],i=n[1],c=n[2],l=n[3];return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return he.lat(i),he.lng(o),he.zoom(l),window.location.hash=he.dumps(),u.value=a,p.value=[o,i],r("moveMap"),t.prev=7,t.next=10,Nt(c,o,i);case 10:n=t.sent,Array.isArray(n)&&e.addFactories(n),t.next=16;break;case 14:t.prev=14,t.t0=t["catch"](7);case 16:case"end":return t.stop()}}),t,null,[[7,14]])})))},onClicked:function(e,a){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a?(r("clickPopup"),t.setPosition(a.getGeometry().getCoordinates()),I(a.getId())):k.show=!1;case 1:case"end":return e.stop()}}),e)})))},onLUILayerVisibilityChange:function(t){C.value=t},onZoomed:function(t){he.zoom(t),window.location.hash=he.dumps()}},{getInitialLocation:function(){if(he.load(window.location),""!==he.dumps())return[he.lng(),he.lat(),he.zoom()]}});e.mapInstance.map.addOverlay(t),m.value=e,e.mapInstance.setLUILayerVisible(!1)}));var z=function(){var t;j.value=j.value+1<3?j.value+1:0,null===(t=m.value)||void 0===t||t.mapInstance.changeBaseMap(j.value)},q=function(){m.value&&m.value.mapInstance.setLUILayerVisible(!1),t.exitSelectFactoryMode()};function X(){m.value&&(m.value.mapInstance.setLUILayerVisible(!0),t.enterSelectFactoryMode(),k.show=!1,P.value=!1,B.value=!1,Yt(q))}function W(){m.value&&(u.value?(m.value.mapInstance.setLUILayerVisible(!1),t.setFactoryLocation(p.value),t.exitSelectFactoryMode(),t.openCreateFactoryForm()):S.showAlert("此地點不在農地範圍內，\n請回報在農地範圍內的工廠。"))}return{root:i,modalActions:g,popup:c,factoryValid:u,baseMapName:E,switchBaseMap:z,toggleLUILayerVisibility:L,setLUILayerVisibilityText:A,zoomToGeolocation:function(){if(m.value){r("zoomToGeolocation");try{m.value.mapInstance.zoomToGeolocation()}catch(t){S.showAlert("您沒開放手機定位權限， \n請開放定位權限以用定位功能。")}}},onNavBack:function(){q()},popupState:k,popupData:x,onClickEditFactoryData:T,onClickCreateFactoryButton:X,onClickFinishSelectFactoryPositionButton:W,getButtonColorFromStatus:function(){var t;if(!_.factoryData)return"default";var e=_t(_.factoryData);return(t={},Object(d["a"])(t,o.NEW,"blue"),Object(d["a"])(t,o.EXISTING_INCOMPLETE,"gray"),Object(d["a"])(t,o.EXISTING_COMPLETE,"gray"),Object(d["a"])(t,o.REPORTED,"default"),t)[e]},locationTooltipVisibility:P,toggleLocationTooltipVisibility:U,locationTooltipControlText:N,factoryLngLat:p,showLocationInput:B,onClickLocationSearch:V,onClickSubmitLocation:$,dismissLocationInput:D,inputLongitude:G,inputLatitude:R}}}),Oe=_e,we=(a("27f0"),Object(y["a"])(Oe,u,p,!1,null,"fd375862",null)),Se=we.exports,Fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{base:!0,open:t.value},attrs:{"data-label":"sidebar-close"},on:{click:t.close}},[a("div",{class:{sidebar:!0,open:t.value}},[a("div",{staticClass:"close",attrs:{"data-label":"sidebar-close"},on:{click:t.close}}),a("h1",[t._v("主選單")]),a("hr"),a("ul",t._l(t.links,(function(e,n){return a("li",{key:n},[a("a",{attrs:{"data-label":"sidebar-"+e.text,href:t.getHref(e),target:t.getTarget(e)},on:{click:function(a){return a.stopPropagation(),t.onClick(e)}}},[t._v(t._s(e.text))])])})),0)])])},Me=[],ke=Object(l["b"])({name:"AppSidebar",props:{value:{type:Boolean,required:!0}},setup:function(t,e){var a=oe(),n=Object(s["a"])(a,2),o=n[1],r=[{text:"使用說明",action:o.openTutorialModal},{text:"安全須知",action:o.openSafetyModal},{text:"聯絡我們",action:o.openContactModal},{text:"常見問題",href:"https://about.disfactory.tw/#section-f_c360c8de-447e-4c0a-a856-4af18b9a5240"},{text:"關於舉報系統",href:"https://about.disfactory.tw"},{text:"問題回報",href:"https://airtable.com/shrUraKakZRpH52DO"}],i=function(){e.emit("input",!1)};return{links:r,close:i,onClick:function(t){"function"===typeof t.action&&t.action()},getHref:function(t){return t.href},getTarget:function(t){return"string"===typeof t.href?"_blank":null}}}}),xe=ke,je=(a("36eb"),Object(y["a"])(xe,Fe,Me,!1,null,"3a461422",null)),Ee=je.exports,Ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.alert?a("div",{staticClass:"app-alert"},[a("div",{staticClass:"close",attrs:{"data-label":"alert-close"},on:{click:t.dismiss}}),a("img",{attrs:{src:"/images/alert.svg",alt:"alert"}}),a("div",[a("div",{staticClass:"alert-title"},[t._v(t._s(t.alert.title))]),a("p",{staticClass:"alert-descriptioin"},[t._v(t._s(t.alert.dismissText))])])]):t._e()},Ae=[],Le=Object(l["b"])({name:"AppAlert",props:{alert:{type:Object},dismiss:{type:Function}}}),Ie=Le,Te=(a("9e22"),Object(y["a"])(Ie,Ce,Ae,!1,null,"2a0f768e",null)),Pe=Te.exports,Be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"navbar-container"},[a("app-navbar",{attrs:{dark:!1,fixed:!0},on:{back:t.onNavBack,menu:t.modalActions.toggleSidebar}},[t._v(" "+t._s(t.isCreateMode?"新增資訊":"補充資訊")+" ")])],1),a("div",{staticClass:"page-container",class:{hide:t.selectFactoryMode}},[a("image-upload-modal",{attrs:{open:t.formPageState.imageUploadModalOpen,dismiss:t.closeImageUploadModal,images:t.imagesToUpload,finishImagesUpload:t.finishImagesUpload,finishUploaderForm:t.finishUploaderForm,mode:t.mode,factoryData:t.factoryData}}),a("div",{staticClass:"page",staticStyle:{padding:"29px 35px"}},[t.isCreateMode?t._e():a("div",{staticClass:"status-banner flex",style:{backgroundColor:t.getStatusBorderColor(t.factoryFormState.status)}},[a("img",{staticStyle:{"margin-right":"7px"},attrs:{src:"/images/marker-white.svg"}}),t._v(" "+t._s(t.FactoryStatusText[t.factoryFormState.status][0])+" ")]),a("h2",[t._v(" 上傳工廠資訊 "),t.isCreateMode?a("small",[a("br"),a("br"),t._v(" 請確認工廠地點， "),a("br"),t._v(" 並上傳至少一張照片。 ")]):a("small",[a("br"),t._v(" 請上傳至少一張照片。 ")])]),a("div",{ref:"minimap",staticClass:"minimap",attrs:{"data-label":"form-minimap"},on:{click:function(e){return t.onClickMinimap()}}}),a("div",{staticClass:"flex justify-between",staticStyle:{"margin-top":"40px","margin-bottom":"20px"}},[a("div",[a("h3",{staticStyle:{"margin-top":"0"}},[t._v("工廠照片*")]),a("div",{staticStyle:{width:"100px","margin-bottom":"15px"}},[a("label",{attrs:{"data-label":"form-add-image"}},[a("input",{ref:"image",staticStyle:{visibility:"hidden",position:"absolute",left:"-1000px"},attrs:{multiple:"",type:"file",accept:"image/*","data-label":"form-add-image",change:"handleImagesUpload"}}),a("app-button",{attrs:{rect:"","data-label":"form-add-image"},on:{click:t.onClickImageUpload}},[t._v("新增")])],1)]),t._m(0)])]),a("div",{staticClass:"images-grid"},t._l(t.factoryFormState.imageUrls,(function(t){return a("div",{key:t,staticClass:"image-card"},[a("img",{attrs:{src:t}})])})),0),t._m(1),a("h3",[t._v("工廠描述")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-text-area",{attrs:{placeholder:"說明為何工廠可疑，\n如聲音類型、氣味類型等等。"},model:{value:t.factoryFormState.others,callback:function(e){t.$set(t.factoryFormState,"others",e)},expression:"factoryFormState.others"}})],1),t.isEditMode?a("div",{staticStyle:{width:"100px",height:"47px","margin-left":"-3px"}},[a("app-button",{attrs:{rect:"",disabled:t.fieldSubmittingState.others_submitting,"data-label":"form-update-others"},on:{click:function(e){return t.updateFactoryFieldsFor("others",t.factoryFormState.others)}}},[t._v(" "+t._s(t.fieldSubmittingState.others_submitting?"更新中":"更新")+" ")])],1):t._e()]),a("h3",[t._v("工廠外部文字")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-text-field",{attrs:{placeholder:"輸入可幫助辨識工廠的文字"},model:{value:t.factoryFormState.name,callback:function(e){t.$set(t.factoryFormState,"name",e)},expression:"factoryFormState.name"}})],1),t.isEditMode?a("div",{staticStyle:{width:"100px",height:"47px","margin-left":"-3px"}},[a("app-button",{attrs:{rect:"",disabled:t.fieldSubmittingState.name_submitting,"data-label":"form-update-name"},on:{click:function(e){return t.updateFactoryFieldsFor("name",t.factoryFormState.name)}}},[t._v(" "+t._s(t.fieldSubmittingState.name_submitting?"更新中":"更新")+" ")])],1):t._e()]),a("h3",[t._v("工廠類型")]),a("div",{staticClass:"flex align-items-center"},[a("div",{staticClass:"flex-auto"},[a("app-select",{attrs:{items:t.factoryTypeItems},model:{value:t.factoryFormState.type,callback:function(e){t.$set(t.factoryFormState,"type",e)},expression:"factoryFormState.type"}})],1),t.isEditMode?a("div",{staticStyle:{width:"100px",height:"47px","margin-left":"-3px"}},[a("app-button",{attrs:{rect:"",disabled:t.fieldSubmittingState.factory_type_submitting,"data-label":"form-update-factoryType"},on:{click:function(e){return t.updateFactoryFieldsFor("factory_type",t.factoryFormState.type)}}},[t._v(" "+t._s(t.fieldSubmittingState.factory_type_submitting?"更新中":"更新")+" ")])],1):t._e()]),t.isCreateMode?a("div",{staticClass:"text-center width-auto",staticStyle:{"margin-top":"60px"}},[a("app-button",{attrs:{disabled:t.formPageState.submitting,"data-label":"form-create-submit"},on:{click:function(e){return t.submitFactory()}}},[t._v(" "+t._s(t.formPageState.submitting?"上傳資料中":"送出")+" ")])],1):t._e()])],1)])},Ue=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("small",[t._v("若您的 iPhone 手機的系統為 iOS 13.3 以下（包含），可能無法上傳照片，工程師搶修中，敬請見諒 🥺")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h2",[t._v(" 補充其他資訊 "),a("small",[a("br"),t._v(" 若無可跳過 ")])])}],Ne=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("textarea",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],attrs:{rows:"7"},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}},"textarea",t.$attrs,!1))},Ge=[],Re=Object(l["b"])({name:"AppTextArea",props:{value:{type:String,required:!0}},setup:function(t,e){var a=Object(l["a"])({get:function(){return t.value},set:function(t){return e.emit("input",t)}});return{inputValue:a}}}),Ve=Re,De=(a("d309"),Object(y["a"])(Ve,Ne,Ge,!1,null,"30fd71d0",null)),$e=De.exports,ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"select"},[a("select",t._b({directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.inputValue=e.target.multiple?a:a[0]}}},"select",t.$attrs,!1),t._l(t.items,(function(e){return a("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0)])},qe=[],Xe=Object(l["b"])({name:"AppSelect",props:{value:{type:null,required:!0},items:{type:Array,required:!0}},setup:function(t,e){var a=Object(l["a"])({get:function(){return t.value},set:function(t){return e.emit("input",t)}});return{inputValue:a}}}),We=Xe,He=(a("312b"),Object(y["a"])(We,ze,qe,!1,null,"4f226c2f",null)),Ze=He.exports,Je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-modal",{staticClass:"page",attrs:{open:t.open,dismiss:t.closeModal}},[a("h2",[t._v("工廠照片")]),a("div",{staticClass:"images-grid"},t._l(t.imageUrls,(function(t){return a("div",{key:t,staticClass:"image-card"},[a("img",{attrs:{src:t}})])})),0),a("h2",[t._v(" 聯絡資訊（非必填）"),a("br"),a("small",{staticStyle:{"font-size":"14px"}},[t._v("如果對於照片有疑問，我們會透過您提供的資訊聯絡你。")])]),a("h3",[t._v("稱呼")]),a("app-text-field",{attrs:{placeholder:"例：林先生"},model:{value:t.formState.nickname,callback:function(e){t.$set(t.formState,"nickname",e)},expression:"formState.nickname"}}),a("h3",[t._v("聯絡資料")]),a("app-text-field",{attrs:{placeholder:"例：hi@gmail.tw,0912345678"},model:{value:t.formState.contact,callback:function(e){t.$set(t.formState,"contact",e)},expression:"formState.contact"}}),a("div",{staticStyle:{"margin-top":"35px"}},[a("app-button",{attrs:{disabled:t.formState.uploading,"data-label":"image-upload-submit"},on:{click:function(e){return t.handleImagesUpload()}}},[t._v(" "+t._s(t.formState.uploading?"上傳中":"上傳照片")+" ")])],1)],1)},Ye=[],Ke=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-modal-component",class:{open:t.open}},[a("div",{staticClass:"app-modal-backdrop",attrs:{"data-label":"modal-backdrop"},on:{click:t.dismiss}}),a("div",{staticClass:"app-modal"},[t.showCloseButton?a("div",{staticClass:"close",attrs:{"data-label":"modal-close"},on:{click:t.dismiss}}):t._e(),t._t("default")],2)])},Qe=[],ta=Object(l["b"])({name:"AppModal",props:{open:{type:Boolean,default:!1},dismiss:{type:Function},showCloseButton:{type:Boolean,default:!0}}}),ea=ta,aa=(a("07be"),Object(y["a"])(ea,Ke,Qe,!1,null,"4eec6d33",null)),na=aa.exports,oa=function(t){for(var e=[],a=0;a<t.length;a++)e.push(t[a]);return e},ra=function(t){return URL.createObjectURL(t)},ia=Object(l["b"])({name:"FilterModal",components:{AppModal:na,AppButton:_,AppTextField:L},props:{open:{type:Boolean,default:!1},dismiss:{type:Function,required:!0},images:{type:FileList},finishImagesUpload:{type:Function,required:!0},finishUploaderForm:{type:Function,required:!0},mode:{type:String,required:!0,defaultValue:"create"},factoryData:{type:Object,required:!0}},setup:function(t){var e=te(),a=e.event,n=Object(l["h"])({nickname:"",contact:"",uploading:!1}),o=Object(l["a"])((function(){for(var e=[],a=0;a<t.images.length;a++)e.push(URL.createObjectURL(t.images[a]));return e}));return{formState:n,imageUrls:o,handleImagesUpload:function(){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.uploading=!0,"create"!==t.mode){e.next=20;break}return e.prev=2,a("uploadImages"),e.next=6,zt(t.images);case 6:return r=e.sent,t.finishUploaderForm(n.nickname,n.contact),e.next=10,t.finishImagesUpload(r,o);case 10:n.uploading=!1,t.dismiss(),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](2),n.uploading=!1,console.error(e.t0);case 18:e.next=29;break;case 20:return a("updateFactoryImages"),e.next=23,qt(t.factoryData.id,t.images,{nickname:n.nickname,contact:n.contact});case 23:return i=e.sent,t.finishUploaderForm(n.nickname,n.contact),e.next=27,t.finishImagesUpload(i,oa(t.images).map(ra));case 27:n.uploading=!1,t.dismiss();case 29:case"end":return e.stop()}}),e,null,[[2,14]])})))},closeModal:function(){n.uploading||(t.finishImagesUpload([]),t.finishUploaderForm("",""),t.dismiss())}}}}),ca=ia,sa=(a("9a83"),Object(y["a"])(ca,Je,Ye,!1,null,"6550fe95",null)),la=sa.exports,ua=Object(l["b"])({name:"FormPage",components:{AppButton:_,AppTextField:L,AppTextArea:$e,AppSelect:Ze,AppNavbar:k,ImageUploadModal:la},props:{close:{type:Function,required:!0},selectFactoryMode:{type:Boolean,required:!0},enterSelectFactoryMode:{type:Function,required:!0},exitSelectFactoryMode:{type:Function,required:!0},factoryLocation:{type:Array,required:!0},setCreateFactorySuccessModal:{type:Function,required:!0},mode:{type:String,required:!0,defaultValue:"create"},factoryData:{type:Object,required:!0}},setup:function(t){var e,a=this,n=te(),o=n.event,r=Object(l["d"])(Ht,Object(l["i"])()),i=oe(),c=Object(s["a"])(i,2),u=c[1],p=fe(),m=Object(s["a"])(p,1),v=m[0],b=ge(),g=Object(s["a"])(b,2),y=g[1],h=function(){r.value&&(r.value.mapInstance.setLUILayerVisible(!1),t.close(),t.exitSelectFactoryMode())};Yt(h);var _="edit"===t.mode,O="create"===t.mode,w=[{text:"請選擇工廠類型",value:"0"}].concat(Object(I["a"])(it)),S={name:"",others:"",type:"0",lng:0,lat:0,images:[],imageUrls:[],nickname:"",contact:"",status:""};if(_){var F=t.factoryData;S.name=F.name,S.type=F.factory_type,S.others=F.others,S.imageUrls=F.images.map((function(t){return t.image_path})),S.lng=F.lng,S.lat=F.lat,S.status=_t(F)}var M=Object(l["h"])(S),k=Object(l["h"])({imageUploadModalOpen:!1,valid:!1,submitting:!1}),x=Object(l["h"])({name_submitting:!1,factory_type_submitting:!1,others_submitting:!1});Object(l["j"])((function(){var t=M.images,e=t.length>0;k.valid=e}));var j=function(){k.imageUploadModalOpen=!1,o("closeImageUploadModal")},E=function(){k.imageUploadModalOpen=!0,o("openImageUploadModal")},C=Object(l["i"])([]),A=Object(l["i"])(null),L=function(t,e){M.nickname=t,M.contact=e},T=function(e,n){return Object(f["a"])(a,void 0,void 0,regeneratorRuntime.mark((function a(){var i,c,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=t.factoryData,_&&i){a.next=3;break}return a.abrupt("return");case 3:return c="".concat(e,"_submitting"),a.prev=4,x[c]=!0,o("updateFactory",{field:e}),a.next=9,Wt(i.id,Object(d["a"])({},e,n));case 9:s=a.sent,x[c]=!1,r.value&&(r.value.updateFactory(i.id,s),v.factoryData=s),u.openUpdateFactorySuccessModal(),a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](4),console.error(a.t0);case 18:case"end":return a.stop()}}),a,null,[[4,15]])})))},P=Object(l["i"])(null);return Object(l["e"])((function(){if(r.value){var a=r.value,n=a.mapInstance.map.getView().getCenter();if(e=At(P.value,n),e.addFactories(a.factories),_){var o=t.factoryData;e.mapInstance.setMinimapPin(o.lng,o.lat)}else if(O){var i=Object(s["a"])(t.factoryLocation,2),c=i[0],l=i[1];e.mapInstance.setMinimapPin(c,l)}}})),Object(l["j"])((function(){return t.factoryLocation}),(function(){if(O&&e){var a=Object(s["a"])(t.factoryLocation,2),n=a[0],o=a[1];e.mapInstance.setMinimapPin(n,o)}})),{minimap:P,onClickMinimap:function(){O&&r.value&&(r.value.mapInstance.setLUILayerVisible(!0),t.enterSelectFactoryMode())},factoryFormState:M,formPageState:k,fieldSubmittingState:x,factoryTypeItems:w,containerStyle:{width:"100%"},openImageUploadModal:E,closeImageUploadModal:j,imagesToUpload:C,image:A,onClickImageUpload:function(){A.value.click()},handleImagesUpload:function(t){C.value=t.target.files,E()},finishImagesUpload:function(e,a){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(O)M.imageUrls=a,M.images=e.map((function(t){return t.token}));else if(_)try{o=Object.assign({},t.factoryData),i=e,M.imageUrls=M.imageUrls.concat(a),o.images=o.images.concat(i),r.value&&(r.value.updateFactory(t.factoryData.id,o),v.factoryData=o),u.openUpdateFactorySuccessModal()}catch(c){console.error(c)}case 1:case"end":return n.stop()}}),n)})))},onNavBack:function(){r.value&&h()},submitFactory:function(){return Object(f["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n,i,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(k.valid){e.next=3;break}return y.showAlert("您沒上傳工廠照片，\n請上傳至少一張照片以完成回報。"),e.abrupt("return");case 3:return k.submitting=!0,e.prev=4,a=Object(s["a"])(t.factoryLocation,2),n=a[0],i=a[1],c={name:M.name,others:M.others,type:M.type,lng:n,lat:i,images:M.images,nickname:M.nickname,contact:M.contact},o("createFactory",{lng:n,lat:i}),e.next=10,Xt(c);case 10:l=e.sent,r.value&&r.value.addFactories([l]),e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](4);case 16:return e.prev=16,k.submitting=!1,e.finish(16);case 19:t.close(),t.exitSelectFactoryMode(),t.setCreateFactorySuccessModal(!0);case 22:case"end":return e.stop()}}),e,null,[[4,14,16,19]])})))},finishUploaderForm:L,isEditMode:_,isCreateMode:O,updateFactoryFieldsFor:T,getStatusBorderColor:ht,FactoryStatusText:st,getFactoryStatus:_t,modalActions:u}}}),pa=ua,da=(a("dcd2"),Object(y["a"])(pa,Be,Ue,!1,null,"1c5bbc2f",null)),fa=da.exports,ma=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"filter-modal-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("div",{staticClass:"page-inner"},[a("h2",{staticStyle:{"margin-right":"30px"}},[t._v("篩選")]),t._l(t.FACTORY_STATUS_ITEMS,(function(e){return a("label",{key:e,staticClass:"checkbox-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.filters[e],expression:"filters[status]"}],attrs:{type:"checkbox",name:e},domProps:{checked:Array.isArray(t.filters[e])?t._i(t.filters[e],null)>-1:t.filters[e]},on:{change:function(a){var n=t.filters[e],o=a.target,r=!!o.checked;if(Array.isArray(n)){var i=null,c=t._i(n,i);o.checked?c<0&&t.$set(t.filters,e,n.concat([i])):c>-1&&t.$set(t.filters,e,n.slice(0,c).concat(n.slice(c+1)))}else t.$set(t.filters,e,r)}}}),a("span",{staticClass:"checkbox"}),a("span",{staticClass:"data-type",class:{"has-description":t.FactoryStatusText[e][1]}},[t._v(" "+t._s(t.FactoryStatusText[e][0])+" "),t.FactoryStatusText[e][1]?a("small",[t._v(t._s(t.FactoryStatusText[e][1]))]):t._e()]),a("span",{staticClass:"space"}),a("img",{attrs:{src:"/images/marker-"+e+".svg"}})])}))],2),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("app-button",{attrs:{"data-label":"filter-apply"},on:{click:function(e){return t.onClick()}}},[t._v("確認")])],1)])])],1)},va=[],ba=Object(l["b"])({name:"FilterModal",components:{AppModal:na,AppButton:_},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(t){var e,a=Object(l["h"])((e={},Object(d["a"])(e,o.NEW,!0),Object(d["a"])(e,o.EXISTING_INCOMPLETE,!0),Object(d["a"])(e,o.EXISTING_COMPLETE,!0),Object(d["a"])(e,o.REPORTED,!0),e)),n=Object(l["d"])(Ht,Object(l["i"])());return{filters:a,onClick:function(){if(n.value){var e=Object.entries(a).map((function(t){var e=Object(s["a"])(t,2),a=e[0],n=e[1];return!!n&&a})).filter(Boolean);n.value.setFactoryStatusFilter(e),"function"===typeof t.dismiss&&t.dismiss()}},FACTORY_STATUS_ITEMS:lt,FactoryStatus:o,FactoryStatusText:st}}}),ga=ba,ya=(a("3a40"),Object(y["a"])(ga,ma,va,!1,null,null,null)),ha=ya.exports,_a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"about-dialog-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("h3",[t._v("關於舉報系統")]),a("p",[t._v(" 農地違章工廠舉報系統為協助民眾回報揭露農地違章工廠資訊，並非實際完成舉報。 ")]),a("p",[t._v(" 地球公民基金會將整理資料進行部分案件追蹤，完成舉報者可於「已舉報」案件查見。 ")]),a("p",[t._v(" 105.05.20 前的違章工廠我們將持續收集資訊，但本系統優先針對新增建與中高污染違章工廠進行舉報。 ")]),a("p",[t._v(" 本系統感謝 g0v.tw 社群朋友共同開發。 ")]),a("p",[t._v(" 既有疑似違章工廠資料來源為 2019 年 7 月 30 日取自內政部國土測繪圖資雲"),a("a",{attrs:{href:"https://maps.nlsc.gov.tw/"}},[t._v("網站")]),t._v("。 ")]),a("p",[t._v(" 全站使用者貢獻資料以 "),a("a",{attrs:{href:"https://creativecommons.org/licenses/by/3.0/tw/"}},[t._v("CC BY 姓名標示 3.0")]),t._v(" 釋出，標註「© 農地違章工廠舉報小幫手貢獻者」，原始碼以 MIT 開放授權公開在 "),a("a",{attrs:{href:"https://github.com/Disfactory/Disfactory"}},[t._v("GitHub")]),t._v(" 上 ")])])])],1)},Oa=[],wa=Object(l["b"])({name:"AboutModal",components:{AppModal:na},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Sa=wa,Fa=(a("9769"),Object(y["a"])(Sa,_a,Oa,!1,null,null,null)),Ma=Fa.exports,ka=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contact-modal-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("img",{attrs:{width:"137",src:"/images/cet-logo.png",alt:"Citizen of the Earth Taiwan"}}),a("h3",[t._v(" 有任何舉報相關問題"),a("br"),t._v(" 歡迎聯絡 ")]),a("p",[t._v(" 地球公民基金會"),a("br"),t._v(" TEL: 07-2156809"),a("br"),t._v(" Email: "),a("a",{attrs:{href:"mailto:cet@cet-taiwan.org"}},[t._v("cet@cet-taiwan.org")]),a("br")])])])],1)},xa=[],ja=Object(l["b"])({name:"ContactModal",components:{AppModal:na},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Ea=ja,Ca=(a("f3e5"),Object(y["a"])(Ea,ka,xa,!1,null,null,null)),Aa=Ca.exports,La=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"getting-started-container"},[a("app-modal",{attrs:{open:t.open,showCloseButton:!1,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("h3",[t._v("嗨你好，歡迎來到農地違章工廠回報行動！")]),a("p",[t._v("需要大家協助回報以下資訊：")]),a("ul",[a("li",[t._v("中高污染工廠")]),a("li",[t._v("105.05.20 後新建的違章工廠")])]),a("p",[t._v("大家的回報會由地球公民基金會彙整追蹤後向政府舉報。")]),a("small",[t._v(" 行動前請同意資料貢獻"),a("a",{attrs:{href:"https://license.disfactory.tw/#%E8%BE%B2%E5%9C%B0%E9%81%95%E7%AB%A0%E5%B7%A5%E5%BB%A0%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1%EF%BC%88disfactory%EF%BC%89%E8%B2%A2%E7%8D%BB%E5%8D%94%E8%AD%B0",target:"_blank"}},[t._v("授權條款")]),t._v("與"),a("a",{attrs:{href:"https://license.disfactory.tw/#%E9%9A%B1%E7%A7%81%E6%AC%8A%E6%A2%9D%E6%AC%BE",target:"_blank"}},[t._v("隱私條款")]),t._v("。本網站由"),a("a",{attrs:{href:"https://www.cet-taiwan.org/",target:"_blank"}},[t._v("地球公民基金會")]),t._v("與 "),a("a",{attrs:{href:"https://g0v.tw/",target:"_blank"}},[t._v("g0v.tw")]),t._v(" 社群共同開發。 ")]),a("app-button",{on:{click:t.agree}},[t._v("我同意加入回報")]),a("small",[a("a",{attrs:{href:"https://about.disfactory.tw"}},[t._v("我不同意，請帶我離開這個頁面")])])],1)])],1)},Ia=[],Ta=Object(l["b"])({name:"GettingStartedModal",components:{AppModal:na,AppButton:_},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(t){return{agree:function(){localStorage.setItem("use-app","true"),t.dismiss&&t.dismiss()}}}}),Pa=Ta,Ba=(a("d1c5"),Object(y["a"])(Pa,La,Ia,!1,null,null,null)),Ua=Ba.exports,Na=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tutorial-modal-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.onDismissClick}},[t.isAdd||t.isUpdate?a("div",{staticClass:"back-button",on:{click:t.openHome}},[a("span"),a("span"),a("span")]):t._e(),a("div",{staticClass:"page"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isHome,expression:"isHome"}],attrs:{id:"tutorial-home"}},[a("h2",[t._v("使用說明")]),a("p",[t._v(" 如果系統無法讀取你的位置， 請至手機系統設定開啟位置權限。 ")]),a("div",{staticClass:"outline-button",on:{click:t.openAdd}},[t._v("如何新增一筆"),a("br"),t._v("違章工廠的資料？")]),a("div",{staticClass:"outline-button",on:{click:t.openUpdate}},[t._v("如何在一筆資料裡"),a("br"),t._v("補充更多資訊？")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isAdd,expression:"isAdd"}],attrs:{id:"tutorial-add-factory"}},[a("carousel",{ref:"createCarousel",attrs:{"per-page":1,paginationActiveColor:"#6E8501",paginationColor:"#e3e3e3",paginationPadding:5}},t._l(t.addImages,(function(e,n){return a("slide",{key:e},[a("h2",[t._v("新增違章工廠("+t._s(n+1)+"/5)")]),a("img",{attrs:{src:e}})])})),1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isUpdate,expression:"isUpdate"}],attrs:{id:"tutorial-update-factory"}},[a("carousel",{ref:"updateCarousel",attrs:{"per-page":1,paginationActiveColor:"#6E8501",paginationColor:"#e3e3e3",paginationPadding:5}},t._l(t.updateImages,(function(e,n){return a("slide",{key:e},[a("h2",[t._v("補充工廠資訊("+t._s(n+1)+"/2)")]),a("img",{attrs:{src:e}})])})),1)],1)])])],1)},Ga=[],Ra=(a("cb29"),a("0a63")),Va=Object(l["b"])({name:"TutorialModal",components:{AppModal:na,Carousel:Ra["Carousel"],Slide:Ra["Slide"]},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(t){var e=Object(l["i"])("home"),a=Object(l["a"])((function(){return"home"===e.value})),n=Object(l["a"])((function(){return"add"===e.value})),o=Object(l["a"])((function(){return"update"===e.value})),r=Object(l["i"])(null),i=Object(l["i"])(null),c=function(){e.value="home"},s=function(){r.value.goToPage(0),e.value="add"},u=function(){i.value.goToPage(0),e.value="update"},p=new Array(5).fill(!0).map((function(t,e){return"/images/tutorial/new_".concat(e+1,".png")})),d=new Array(2).fill(!0).map((function(t,e){return"/images/tutorial/update_".concat(e+1,".png")})),f=function(){c(),t.dismiss()};return{isHome:a,isAdd:n,isUpdate:o,openHome:c,openAdd:s,openUpdate:u,addImages:p,updateImages:d,onDismissClick:f,createCarousel:r,updateCarousel:i}}}),Da=Va,$a=(a("1bed"),Object(y["a"])(Da,Na,Ga,!1,null,null,null)),za=$a.exports,qa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"safety-modal-container"},[a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[a("div",{staticClass:"page"},[a("carousel",{attrs:{"per-page":1,paginationActiveColor:"#6E8501",paginationColor:"#e3e3e3",paginationPadding:5}},[a("slide",[a("h1",[t._v("安全須知")]),a("p",[t._v(" 請參考以下建議，前往違章工廠拍照蒐證 ")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/1.png",alt:""}}),a("h2",[t._v(" 場勘 ")]),a("p",[t._v(" 假裝路過，檢查有無監視器；尋找適合拍照的隱蔽處 ")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/2.png",alt:""}}),a("h2",[t._v("藏身")]),a("p",[t._v(" 盡量避開監視器、他人視線；盡量在隱蔽處拍照（例如：車上、民宅內、樹叢間、遠方） ")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/3.png",alt:""}}),a("h2",[t._v("避嫌")]),a("p",[t._v("假如地點不夠隱密，請用手機拍照，降低他人戒心")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/4.png",alt:""}}),a("h2",[t._v("速離")]),a("p",[t._v("拍到1張清晰照片即可離去")])]),a("slide",[a("img",{attrs:{src:"/images/safety_notice/5.png",alt:""}}),a("h2",[t._v("應變")]),a("p",[t._v("假如有人上前問話，請表現得「充滿好奇心」，試著跟對方聊天（例如：好奇水電師傅的施工技術），再伺機離開。")])])],1)],1)])],1)},Xa=[],Wa=Object(l["b"])({name:"SafetyModal",components:{AppModal:na,Carousel:Ra["Carousel"],Slide:Ra["Slide"]},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Ha=Wa,Za=(a("0751"),Object(y["a"])(Ha,qa,Xa,!1,null,null,null)),Ja=Za.exports,Ya=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss,showCloseButton:!1}},[a("h3",[t._v("感謝您新增資訊！")]),a("app-button",{attrs:{"data-label":"create-factory-success-close"},on:{click:t.dismiss}},[t._v("確認")])],1)},Ka=[],Qa=Object(l["b"])({name:"CreateFactorySuccessModal",components:{AppModal:na,AppButton:_},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),tn=Qa,en=(a("b4fe"),Object(y["a"])(tn,Ya,Ka,!1,null,"f1cd472e",null)),an=en.exports,nn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-modal",{attrs:{open:t.open,dismiss:t.dismiss,showCloseButton:!1}},[a("h3",[t._v("感謝您補充資訊！")]),a("app-button",{attrs:{"data-label":"update-factory-success-apply"},on:{click:t.dismiss}},[t._v("確認")])],1)},on=[],rn=Object(l["b"])({name:"UpdateFactorySuccessModal",components:{AppModal:na,AppButton:_},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),cn=rn,sn=(a("979a"),Object(y["a"])(cn,nn,on,!1,null,"72bdbd76",null)),ln=sn.exports,un=Object(l["b"])({name:"App",components:{Map:Se,AppAlert:Pe,AppButton:_,AppNavbar:k,AppSidebar:Ee,FilterModal:ha,AboutModal:Ma,ContactModal:Aa,GettingStartedModal:Ua,SafetyModal:Ja,CreateFactorySuccessModal:an,UpdateFactorySuccessModal:ln,TutorialModal:za,FormPage:fa},setup:function(t,e){Qt(e),ie(),pe(),ve(),ne();var a=oe(),n=Object(s["a"])(a,2),o=n[0],r=n[1],i=fe(),c=Object(s["a"])(i,2),u=c[0],p=c[1],d=ge(),f=Object(s["a"])(d,2),m=f[0],v=f[1];return Object(l["g"])(Ht,Object(l["i"])(null)),{appState:u,alertState:m,alertActions:v,appActions:p,modalState:o,modalActions:r}}}),pn=un,dn=(a("5c0b"),Object(y["a"])(pn,i,c,!1,null,null,null)),fn=dn.exports,mn=a("9483");Object(mn["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var vn=a("2bdd"),bn=a.n(vn);r["a"].config.productionTip=!1,r["a"].use(l["c"]),r["a"].use(bn.a,{config:{id:"UA-154739393-1"},enabled:!0}),new r["a"]({render:function(t){return t(fn)}}).$mount("#app")},d1c5:function(t,e,a){"use strict";var n=a("8271"),o=a.n(n);o.a},d1f4:function(t,e,a){},d309:function(t,e,a){"use strict";var n=a("d1f4"),o=a.n(n);o.a},d3a7:function(t,e,a){},dcd2:function(t,e,a){"use strict";var n=a("79b8"),o=a.n(n);o.a},e405:function(t,e,a){"use strict";var n=a("d3a7"),o=a.n(n);o.a},f3de:function(t,e,a){},f3e5:function(t,e,a){"use strict";var n=a("31aa"),o=a.n(n);o.a}});
//# sourceMappingURL=app-legacy.9f8c9026.js.map